<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Finanzas Familiares</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
:root{--bg:#0d0f14;--bg2:#13161e;--bg3:#1a1e2a;--border:#252a38;--accent:#4ade80;--accent2:#60a5fa;--accent3:#f59e0b;--danger:#f87171;--text:#e8eaf0;--text2:#8892a4;--card:#161b26}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--text);font-family:'Syne',sans-serif;min-height:100vh}
#app{display:flex;height:100vh;overflow:hidden}
#sidebar{width:220px;min-width:220px;background:var(--bg2);border-right:1px solid var(--border);display:flex;flex-direction:column;padding:20px 0}
.logo{padding:0 20px 20px;border-bottom:1px solid var(--border)}
.logo h1{font-size:17px;font-weight:800;color:var(--accent);letter-spacing:-.5px}
.logo p{font-size:10px;font-family:'DM Mono',monospace;color:var(--text2);margin-top:2px}
nav{padding:12px 0;flex:1;overflow-y:auto}
.nav-section{padding:8px 20px 4px;font-size:9px;font-family:'DM Mono',monospace;color:var(--text2);text-transform:uppercase;letter-spacing:1px}
.nav-item{display:flex;align-items:center;gap:10px;padding:9px 20px;cursor:pointer;font-size:13px;font-weight:600;color:var(--text2);border-left:3px solid transparent;transition:all .15s}
.nav-item:hover{color:var(--text);background:var(--bg3)}
.nav-item.active{color:var(--accent);border-left-color:var(--accent);background:rgba(74,222,128,.06)}
.nav-icon{font-size:15px;width:18px;text-align:center}
.nav-user{padding:12px 20px;border-top:1px solid var(--border)}
.nav-user-email{font-size:10px;font-family:'DM Mono',monospace;color:var(--text2);margin-bottom:6px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
#main{flex:1;overflow-y:auto;background:var(--bg)}
.topbar{position:sticky;top:0;z-index:10;background:var(--bg);border-bottom:1px solid var(--border);padding:14px 24px;display:flex;align-items:center;justify-content:space-between}
.topbar h2{font-size:19px;font-weight:800}
.topbar-actions{display:flex;gap:8px;align-items:center}
.page{padding:18px 24px}
.kpi-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:16px}
.kpi{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;position:relative;overflow:hidden}
.kpi::before{content:'';position:absolute;top:0;left:0;right:0;height:2px}
.kpi.green::before{background:var(--accent)}.kpi.blue::before{background:var(--accent2)}.kpi.yellow::before{background:var(--accent3)}.kpi.red::before{background:var(--danger)}
.kpi-label{font-size:10px;font-family:'DM Mono',monospace;color:var(--text2);text-transform:uppercase;letter-spacing:.5px}
.kpi-value{font-size:20px;font-weight:800;margin:5px 0 2px;letter-spacing:-1px}
.kpi-sub{font-size:11px;font-family:'DM Mono',monospace;color:var(--text2)}
.btn{padding:8px 14px;border-radius:8px;border:none;cursor:pointer;font-family:'Syne',sans-serif;font-weight:700;font-size:12px;transition:all .15s}
.btn-primary{background:var(--accent);color:#000}.btn-primary:hover{background:#3cc76e}
.btn-secondary{background:var(--bg3);color:var(--text);border:1px solid var(--border)}.btn-secondary:hover{border-color:var(--accent2)}
.btn-danger{background:rgba(248,113,113,.15);color:var(--danger);border:1px solid rgba(248,113,113,.3)}
.btn-sm{padding:4px 9px;font-size:11px}
.btn-icon{background:none;border:none;cursor:pointer;color:var(--text2);font-size:13px;padding:3px 6px;border-radius:4px}
.btn-icon:hover{color:var(--danger);background:rgba(248,113,113,.1)}
.table-wrap{background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;margin-bottom:16px}
.table-header{padding:12px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.table-header h3{font-size:13px;font-weight:700}
table{width:100%;border-collapse:collapse}
th{padding:9px 14px;text-align:left;font-size:10px;font-family:'DM Mono',monospace;color:var(--text2);text-transform:uppercase;letter-spacing:.5px;background:var(--bg3);border-bottom:1px solid var(--border)}
td{padding:9px 14px;font-size:13px;border-bottom:1px solid var(--border)}
tr:last-child td{border-bottom:none}
tr:hover td{background:rgba(255,255,255,.02)}
.filters{display:flex;gap:8px;margin-bottom:14px;flex-wrap:wrap;align-items:center}
select,input[type=text],input[type=date],input[type=number]{background:var(--bg3);border:1px solid var(--border);color:var(--text);padding:7px 11px;border-radius:8px;font-family:'DM Mono',monospace;font-size:12px;outline:none;transition:border .15s}
select:focus,input:focus{border-color:var(--accent2)}
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:100;display:flex;align-items:center;justify-content:center}
.modal-overlay.hidden{display:none}
.modal{background:var(--bg2);border:1px solid var(--border);border-radius:16px;padding:24px;width:520px;max-width:95vw;max-height:90vh;overflow-y:auto}
.modal h3{font-size:17px;font-weight:800;margin-bottom:18px}
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.form-full{grid-column:1/-1}
label{display:block;font-size:10px;font-family:'DM Mono',monospace;color:var(--text2);margin-bottom:4px;text-transform:uppercase;letter-spacing:.4px}
.form-group{display:flex;flex-direction:column}
input[type=text],input[type=date],input[type=number],select{width:100%}
.modal-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:18px}
.chart-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:18px}
.chart-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px}
.chart-card h3{font-size:10px;font-family:'DM Mono',monospace;color:var(--text2);text-transform:uppercase;letter-spacing:.5px;margin-bottom:12px}
.bar-row{display:flex;align-items:center;gap:8px;margin-bottom:6px}
.bar-label{font-size:11px;font-family:'DM Mono',monospace;color:var(--text2);width:140px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.bar-track{flex:1;height:6px;background:var(--bg3);border-radius:3px;overflow:hidden}
.bar-fill{height:100%;border-radius:3px;transition:width .4s}
.bar-val{font-size:11px;font-family:'DM Mono',monospace;color:var(--text);width:90px;text-align:right}
.mes-tabs{display:flex;gap:5px;margin-bottom:14px;flex-wrap:wrap}
.mes-tab{padding:6px 12px;border-radius:6px;cursor:pointer;font-size:12px;font-weight:700;background:var(--bg3);color:var(--text2);border:1px solid var(--border);transition:all .15s}
.mes-tab.active{background:rgba(74,222,128,.1);color:var(--accent);border-color:rgba(74,222,128,.3)}
.split-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px;margin-bottom:18px}
.split-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px}
.split-card h4{font-size:10px;font-family:'DM Mono',monospace;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px}
.grupo-tag{display:inline-block;padding:2px 7px;border-radius:4px;font-size:9px;font-family:'DM Mono',monospace;font-weight:600;text-transform:uppercase}
.grupo-fijo{background:rgba(96,165,250,.12);color:var(--accent2);border:1px solid rgba(96,165,250,.2)}
.grupo-variable{background:rgba(245,158,11,.12);color:var(--accent3);border:1px solid rgba(245,158,11,.2)}
.grupo-financiero{background:rgba(167,139,250,.12);color:#a78bfa;border:1px solid rgba(167,139,250,.2)}
.tarjeta-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;position:relative;overflow:hidden}
.tarjeta-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
.tc-VG::before{background:linear-gradient(90deg,#1a56db,#3b82f6)}.tc-MG::before{background:linear-gradient(90deg,#eb5757,#f87171)}.tc-MN::before{background:linear-gradient(90deg,#059669,#34d399)}.tc-VM::before{background:linear-gradient(90deg,#7c3aed,#a78bfa)}.tc-AE::before{background:linear-gradient(90deg,#b45309,#f59e0b)}.tc-AM::before{background:linear-gradient(90deg,#c2410c,#fb923c)}.tc-VGD::before{background:linear-gradient(90deg,#1d4ed8,#60a5fa)}.tc-MGD::before{background:linear-gradient(90deg,#be185d,#f472b6)}.tc-VFD::before{background:linear-gradient(90deg,#3f6212,#a3e635)}
.tarjeta-nombre{font-size:12px;font-weight:800;margin-bottom:2px}
.tarjeta-info{font-size:10px;font-family:'DM Mono',monospace;color:var(--text2);margin-bottom:10px}
.tarjeta-monto{font-size:20px;font-weight:800;letter-spacing:-1px;margin-bottom:6px}
.tarjeta-vto{font-size:10px;font-family:'DM Mono',monospace;padding:3px 8px;border-radius:4px;display:inline-block}
.vto-urgente{background:rgba(248,113,113,.15);color:var(--danger);border:1px solid rgba(248,113,113,.3)}
.vto-pronto{background:rgba(245,158,11,.15);color:var(--accent3);border:1px solid rgba(245,158,11,.3)}
.vto-ok{background:rgba(74,222,128,.1);color:var(--accent);border:1px solid rgba(74,222,128,.2)}
.tarjetas-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:18px}
.resumen-badge{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:4px;font-size:10px;font-family:'DM Mono',monospace;background:rgba(96,165,250,.1);color:var(--accent2);border:1px solid rgba(96,165,250,.2)}
.cuota-badge{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:4px;font-size:10px;font-family:'DM Mono',monospace;background:rgba(245,158,11,.1);color:var(--accent3);border:1px solid rgba(245,158,11,.2)}
.futura-badge{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:4px;font-size:10px;font-family:'DM Mono',monospace;background:rgba(167,139,250,.1);color:#a78bfa;border:1px solid rgba(167,139,250,.2)}
.info-box{background:var(--bg3);border:1px solid var(--border);border-radius:8px;padding:10px 14px;font-size:12px;font-family:'DM Mono',monospace;color:var(--text2);margin-bottom:14px}
.info-box strong{color:var(--text)}.info-box.ok{border-color:rgba(74,222,128,.3);background:rgba(74,222,128,.05)}.info-box.warn{border-color:rgba(245,158,11,.3);background:rgba(245,158,11,.05)}
.settings-section{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:18px;margin-bottom:16px}
.settings-section h3{font-size:11px;font-family:'DM Mono',monospace;color:var(--text2);text-transform:uppercase;letter-spacing:.5px;margin-bottom:12px}
.cat-list{display:flex;flex-direction:column;gap:6px}
.cat-item{display:flex;align-items:center;gap:8px;padding:8px 10px;background:var(--bg3);border-radius:8px;border:1px solid var(--border)}
.cat-item-name{flex:1;font-size:13px;font-weight:600}
.cat-add-row{display:flex;gap:8px;margin-top:10px}.cat-add-row input,.cat-add-row select{flex:1}
.periodos-table{width:100%;border-collapse:collapse;margin-top:8px}
.periodos-table th{padding:7px 10px;text-align:left;font-size:10px;font-family:'DM Mono',monospace;color:var(--text2);text-transform:uppercase;background:var(--bg3);border-bottom:1px solid var(--border)}
.periodos-table td{padding:6px 10px;font-size:12px;border-bottom:1px solid var(--border);font-family:'DM Mono',monospace}
.periodos-table input{padding:4px 8px;font-size:11px;width:120px}
.quien-badge{display:inline-block;padding:2px 7px;border-radius:4px;font-size:10px;font-family:'DM Mono',monospace;font-weight:700}
.quien-leo{background:rgba(74,222,128,.1);color:var(--accent);border:1px solid rgba(74,222,128,.2)}
.quien-dayu{background:rgba(167,139,250,.1);color:#a78bfa;border:1px solid rgba(167,139,250,.2)}
.text-mono{font-family:'DM Mono',monospace}
.monto-positivo{color:var(--accent);font-family:'DM Mono',monospace;font-weight:500}
.monto-negativo{color:var(--danger);font-family:'DM Mono',monospace;font-weight:500}
.monto-futura{color:#a78bfa;font-family:'DM Mono',monospace;font-weight:500}
.empty-state{padding:36px;text-align:center;color:var(--text2);font-family:'DM Mono',monospace;font-size:12px}
::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:var(--bg)}::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
</style>
</head>
<body>

<div id="login-screen" style="position:fixed;inset:0;background:var(--bg);display:flex;align-items:center;justify-content:center;z-index:999;flex-direction:column;gap:20px">
  <div style="text-align:center">
    <div style="font-size:40px;margin-bottom:12px">üí∞</div>
    <h1 style="font-size:24px;font-weight:800;color:var(--accent);margin-bottom:4px">Finanzas Familiares</h1>
    <p style="font-size:12px;font-family:'DM Mono',monospace;color:var(--text2)">Acceso privado ¬∑ Solo familia</p>
  </div>
  <button id="btn-google-login" style="display:flex;align-items:center;gap:10px;background:#fff;color:#1f1f1f;border:none;padding:12px 24px;border-radius:10px;font-family:'Syne',sans-serif;font-size:14px;font-weight:700;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,.3)">
    <svg width="18" height="18" viewBox="0 0 48 48"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.18 1.48-4.97 2.31-8.16 2.31-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/></svg>
    Entrar con Google
  </button>
  <div id="login-error" style="color:var(--danger);font-size:12px;font-family:'DM Mono',monospace;display:none"></div>
</div>

<div id="app" style="display:none">
  <div id="sidebar">
    <div class="logo"><h1>üí∞ Finanzas</h1><p id="sync-status">‚óè Conectando...</p></div>
    <nav>
      <div class="nav-section">Principal</div>
      <div class="nav-item active" onclick="navTo('dashboard',this)"><span class="nav-icon">üìä</span>Dashboard</div>
      <div class="nav-item" onclick="navTo('movimientos',this)"><span class="nav-icon">üìã</span>Movimientos</div>
      <div class="nav-section">Tarjetas</div>
      <div class="nav-item" onclick="navTo('resumenes',this)"><span class="nav-icon">üí≥</span>Res√∫menes</div>
      <div class="nav-item" onclick="navTo('config-tarjetas',this)"><span class="nav-icon">üóìÔ∏è</span>Fechas tarjetas</div>
      <div class="nav-section">An√°lisis</div>
      <div class="nav-item" onclick="navTo('categorias',this)"><span class="nav-icon">üè∑Ô∏è</span>Por Categor√≠a</div>
      <div class="nav-item" onclick="navTo('comparativa',this)"><span class="nav-icon">üìà</span>Comparativa</div>
      <div class="nav-section">Config</div>
      <div class="nav-item" onclick="navTo('config',this)"><span class="nav-icon">‚öôÔ∏è</span>Categor√≠as</div>
    </nav>
    <div class="nav-user">
      <div class="nav-user-email" id="user-email"></div>
      <button class="btn btn-secondary btn-sm" style="width:100%" onclick="cerrarSesion()">Cerrar sesi√≥n</button>
    </div>
  </div>
  <div id="main">
    <div id="page-dashboard" class="page-section">
      <div class="topbar"><h2>Dashboard</h2><div class="topbar-actions"><button class="btn btn-primary" onclick="abrirModal()">+ Nuevo movimiento</button></div></div>
      <div class="page">
        <div class="mes-tabs" id="mes-tabs-dash"></div>
        <div class="kpi-grid" id="kpis"></div>
        <div class="split-grid" id="split-cards"></div>
        <div class="chart-grid">
          <div class="chart-card"><h3>Top categor√≠as</h3><div id="chart-cat"></div></div>
          <div class="chart-card"><h3>Ingresos vs Gastos</h3><div id="chart-ing-gas"></div></div>
        </div>
        <div class="table-wrap">
          <div class="table-header"><h3>√öltimos movimientos</h3></div>
          <table><thead><tr><th>Fecha</th><th>Qui√©n</th><th>Descripci√≥n</th><th>Categor√≠a</th><th>Tarjeta</th><th>Resumen</th><th>Monto</th></tr></thead>
          <tbody id="tbody-recientes"></tbody></table>
        </div>
      </div>
    </div>

    <div id="page-movimientos" class="page-section" style="display:none">
      <div class="topbar"><h2>Movimientos</h2><div class="topbar-actions"><button class="btn btn-primary" onclick="abrirModal()">+ Nuevo</button><button class="btn btn-secondary" onclick="exportarCSV()">‚Üì CSV</button></div></div>
      <div class="page">
        <div class="filters">
          <select id="fil-mes" onchange="renderMovimientos()">
            <option value="">Todos los meses</option>
            <option value="2026-01">Enero</option><option value="2026-02">Febrero</option><option value="2026-03">Marzo</option>
            <option value="2026-04">Abril</option><option value="2026-05">Mayo</option><option value="2026-06">Junio</option>
            <option value="2026-07">Julio</option><option value="2026-08">Agosto</option>
          </select>
          <select id="fil-tipo" onchange="renderMovimientos()">
            <option value="">Todos</option><option value="gasto">Gastos</option><option value="ingreso">Ingresos</option>
          </select>
          <select id="fil-quien" onchange="renderMovimientos()">
            <option value="">Todos</option><option value="Leo">Leo</option><option value="Dayu">Dayu</option>
          </select>
          <select id="fil-tarjeta" onchange="renderMovimientos()">
            <option value="">Todas tarjetas</option>
            <option value="VG">VG</option><option value="MG">MG</option><option value="MN">MN</option>
            <option value="VM">VM</option><option value="AE">AE</option><option value="AM">AM</option>
            <option value="VGD">VGD</option><option value="MGD">MGD</option><option value="VFD">VFD</option>
            <option value="efectivo">Efectivo</option>
          </select>
          <select id="fil-cat" onchange="renderMovimientos()"><option value="">Todas las categor√≠as</option></select>
          <select id="fil-cuotas" onchange="renderMovimientos()">
            <option value="">Todos</option><option value="cuota">Solo cuotas</option><option value="normal">Sin cuotas</option><option value="futura">Cuotas futuras</option>
          </select>
          <input type="text" id="fil-buscar" placeholder="Buscar..." oninput="renderMovimientos()" style="min-width:110px">
        </div>
        <div class="table-wrap">
          <div class="table-header"><h3 id="mov-count"></h3><span id="mov-total" class="text-mono" style="font-size:12px;color:var(--text2)"></span></div>
          <table><thead><tr><th>Fecha</th><th>Qui√©n</th><th>Descripci√≥n</th><th>Categor√≠a</th><th>Tarjeta</th><th>Resumen</th><th>Monto</th><th></th></tr></thead>
          <tbody id="tbody-movimientos"></tbody></table>
        </div>
      </div>
    </div>

    <div id="page-resumenes" class="page-section" style="display:none">
      <div class="topbar"><h2>Res√∫menes</h2></div>
      <div class="page">
        <div class="mes-tabs" id="mes-tabs-res"></div>
        <div class="info-box" id="info-resumenes"></div>
        <div class="tarjetas-grid" id="tarjetas-grid"></div>
        <div class="table-wrap">
          <div class="table-header"><h3 id="res-titulo">Detalle</h3></div>
          <table><thead><tr><th>Fecha</th><th>Qui√©n</th><th>Descripci√≥n</th><th>Categor√≠a</th><th>Tarjeta</th><th>Monto</th></tr></thead>
          <tbody id="tbody-resumenes"></tbody></table>
        </div>
      </div>
    </div>

    <div id="page-config-tarjetas" class="page-section" style="display:none">
      <div class="topbar"><h2>Fechas de Tarjetas</h2></div>
      <div class="page">
        <div class="info-box">Edit√° el cierre y vencimiento exacto por mes. Al modificar, recalcula todos los gastos autom√°ticamente.</div>
        <div id="config-tarjetas-content"></div>
      </div>
    </div>

    <div id="page-categorias" class="page-section" style="display:none">
      <div class="topbar"><h2>Por Categor√≠a</h2></div>
      <div class="page">
        <div class="mes-tabs" id="mes-tabs-cat"></div>
        <div class="chart-grid">
          <div class="chart-card"><h3>Gastos Fijos</h3><div id="chart-fijos"></div></div>
          <div class="chart-card"><h3>Gastos Variables</h3><div id="chart-variables"></div></div>
        </div>
        <div class="table-wrap"><table><thead><tr><th>Categor√≠a</th><th>Grupo</th><th>Movs</th><th>Total</th><th>%</th></tr></thead><tbody id="tbody-cat"></tbody></table></div>
      </div>
    </div>

    <div id="page-comparativa" class="page-section" style="display:none">
      <div class="topbar"><h2>Comparativa</h2></div>
      <div class="page">
        <div class="kpi-grid" id="kpis-comp"></div>
        <div class="chart-grid">
          <div class="chart-card"><h3>Ingresos vs Gastos</h3><div id="chart-comp1"></div></div>
          <div class="chart-card"><h3>Fijos vs Variables</h3><div id="chart-comp2"></div></div>
        </div>
      </div>
    </div>

    <div id="page-config" class="page-section" style="display:none">
      <div class="topbar"><h2>Categor√≠as</h2></div>
      <div class="page">
        <div id="config-grupos"></div>
        <div class="settings-section"><h3>Agregar categor√≠a</h3>
          <div class="cat-add-row">
            <input type="text" id="new-cat-name" placeholder="Nombre">
            <select id="new-cat-grupo"><option value="fijo">Gasto Fijo</option><option value="variable">Gasto Variable</option><option value="financiero">Financiero/Salud</option><option value="ingreso">Ingreso</option></select>
            <button class="btn btn-primary" onclick="agregarCategoria()">+ Agregar</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal-overlay hidden" id="modal-overlay">
  <div class="modal">
    <h3>Nuevo movimiento</h3>
    <div class="form-grid">
      <div class="form-group form-full"><label>Tipo</label>
        <select id="m-tipo" onchange="actualizarCatsModal();calcularResumen()">
          <option value="gasto">üí∏ Gasto</option><option value="ingreso">üí∞ Ingreso</option>
        </select>
      </div>
      <div class="form-group"><label>Fecha</label><input type="date" id="m-fecha" onchange="calcularResumen()"></div>
      <div class="form-group"><label>Monto ($ARS)</label><input type="number" id="m-monto" placeholder="0"></div>
      <div class="form-group form-full"><label>Descripci√≥n</label><input type="text" id="m-desc" placeholder="Ej: Cena restor√°n"></div>
      <div class="form-group"><label>Categor√≠a</label><select id="m-cat"></select></div>
      <div class="form-group"><label>Medio de pago</label>
        <select id="m-cuenta" onchange="calcularResumen();toggleCuotas()">
          <option value="">Efectivo / D√©bito</option>
          <option value="VG">üí≥ VG - Visa Galicia (Leo)</option>
          <option value="MG">üí≥ MG - MC Galicia (Leo)</option>
          <option value="MN">üí≥ MN - MC Naci√≥n (Leo)</option>
          <option value="VM">üí≥ VM - Visa Macro (Leo)</option>
          <option value="AE">üí≥ AE - Amex (Leo)</option>
          <option value="AM">üí≥ AM - Amex Macro (Leo)</option>
          <option value="VGD">üí≥ VGD - Visa Galicia (Dayu)</option>
          <option value="MGD">üí≥ MGD - MC Galicia (Dayu)</option>
          <option value="VFD">üí≥ VFD - Visa Franc√©s (Dayu)</option>
        </select>
      </div>
      <div class="form-group form-full" id="cuotas-row" style="display:none">
        <label>Cuotas</label>
        <select id="m-cuotas" onchange="calcularResumen()">
          <option value="1">1 cuota (pago √∫nico)</option>
          <option value="2">2 cuotas</option><option value="3">3 cuotas</option><option value="4">4 cuotas</option>
          <option value="5">5 cuotas</option><option value="6">6 cuotas</option><option value="9">9 cuotas</option>
          <option value="12">12 cuotas</option><option value="18">18 cuotas</option>
        </select>
      </div>
      <div class="form-group form-full" id="resumen-info-row" style="display:none">
        <div id="resumen-info" class="info-box" style="margin-bottom:0"></div>
      </div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="cerrarModal()">Cancelar</button>
      <button class="btn btn-primary" onclick="guardarMovimiento()">Guardar</button>
    </div>
  </div>
</div>


<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, addDoc, deleteDoc, doc, onSnapshot, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";


const firebaseConfig = {
  apiKey: "AIzaSyCY4PWO2m84gD6-zScKlHiWHhhGpnlmNDs",
  authDomain: "finanzas-familia-30c39.firebaseapp.com",
  projectId: "finanzas-familia-30c39",
  storageBucket: "finanzas-familia-30c39.firebasestorage.app",
  messagingSenderId: "732450617135",
  appId: "1:732450617135:web:0668cbbc0404a65aaa93da"
};
const fbApp = initializeApp(firebaseConfig);
const db = getFirestore(fbApp);
const auth = getAuth(fbApp);
const provider = new GoogleAuthProvider();
const EMAILS_OK = ['brukmanleonel@gmail.com', 'daianastarosc@gmail.com'];


const GRUPOS_DEFAULT=[
  {id:'fijo',nombre:'Gastos Fijos',cats:['Alquiler','Servicios','Seguros','Jard√≠n Noah','Gimnasio','Suscripciones','Monotributo/IIBB','Matr√≠cula Provincial','Empleada']},
  {id:'variable',nombre:'Gastos Variables',cats:['Supermercado','Delivery','Salidas','Caf√©/Kiosko','Compras','Actividades','Educaci√≥n','Transporte','Turismo','Ni√±era','Farmacia','Dayu','Otros']},
  {id:'financiero',nombre:'Financieros / Salud',cats:['Salud','Gastos financieros']},
  {id:'ingreso',nombre:'Ingresos',cats:['CENEMAR','Escuela de Medicina','Consultorio','Investigaci√≥n/Ensayo','Alquiler cobrado','Beca Dayu','Promociones/Cashback','Ventas','Intereses inversiones']}
];
const COLORES={fijo:['#60a5fa','#38bdf8','#34d399','#4ade80','#86efac','#a3e635','#fbbf24','#fb923c','#f87171'],variable:['#f59e0b','#fcd34d','#f472b6','#e879f9','#a78bfa','#818cf8','#c084fc','#22d3ee','#2dd4bf','#4ade80','#fb7185','#94a3b8','#64748b'],financiero:['#a78bfa','#f87171'],ingreso:['#4ade80','#34d399','#6ee7b7','#86efac','#bbf7d0','#a7f3d0','#d1fae5']};
const NOMBRES_MES={'2026-01':'Ene','2026-02':'Feb','2026-03':'Mar','2026-04':'Abr','2026-05':'May','2026-06':'Jun','2026-07':'Jul','2026-08':'Ago','2026-09':'Sep','2026-10':'Oct','2026-11':'Nov','2026-12':'Dic','2027-01':'Ene 27','2027-02':'Feb 27','2027-03':'Mar 27','2027-04':'Abr 27','2027-05':'May 27','2027-06':'Jun 27'};
const NOMBRES_MES_L={'2026-01':'Enero','2026-02':'Febrero','2026-03':'Marzo','2026-04':'Abril','2026-05':'Mayo','2026-06':'Junio','2026-07':'Julio','2026-08':'Agosto','2026-09':'Septiembre','2026-10':'Octubre','2026-11':'Noviembre','2026-12':'Diciembre','2027-01':'Enero 2027','2027-02':'Febrero 2027','2027-03':'Marzo 2027','2027-04':'Abril 2027','2027-05':'Mayo 2027','2027-06':'Junio 2027'};
const TARJETAS_META={
  VG:{nombre:"Visa Galicia (Leo)",color:"#3b82f6"},
  MG:{nombre:"Mastercard Galicia (Leo)",color:"#f87171"},
  MN:{nombre:"Mastercard Naci√≥n (Leo)",color:"#34d399"},
  VM:{nombre:"Visa Macro (Leo)",color:"#a78bfa"},
  AE:{nombre:"Amex (Leo)",color:"#f59e0b"},
  AM:{nombre:"Amex Macro (Leo)",color:"#fb923c"},
  VGD:{nombre:"Visa Galicia (Dayu)",color:"#60a5fa"},
  MGD:{nombre:"MC Galicia (Dayu)",color:"#f472b6"},
  VFD:{nombre:"Visa Franc√©s (Dayu)",color:"#a3e635"}
};
const PERIODOS_DEFAULT={"VG": {"2026-01": {"cierre": "2026-01-19", "vto": "2026-02-02"}, "2026-02": {"cierre": "2026-02-19", "vto": "2026-03-02"}, "2026-03": {"cierre": "2026-03-19", "vto": "2026-04-02"}, "2026-04": {"cierre": "2026-04-19", "vto": "2026-05-02"}, "2026-05": {"cierre": "2026-05-19", "vto": "2026-06-02"}, "2026-06": {"cierre": "2026-06-19", "vto": "2026-07-02"}, "2026-07": {"cierre": "2026-07-19", "vto": "2026-08-02"}, "2026-08": {"cierre": "2026-08-19", "vto": "2026-09-02"}, "2026-09": {"cierre": "2026-09-19", "vto": "2026-10-02"}, "2026-10": {"cierre": "2026-10-19", "vto": "2026-11-02"}, "2026-11": {"cierre": "2026-11-19", "vto": "2026-12-02"}, "2026-12": {"cierre": "2026-12-19", "vto": "2027-01-02"}, "2027-01": {"cierre": "2027-01-19", "vto": "2027-02-02"}, "2027-02": {"cierre": "2027-02-19", "vto": "2027-03-02"}, "2027-03": {"cierre": "2027-03-19", "vto": "2027-04-02"}, "2027-04": {"cierre": "2027-04-19", "vto": "2027-05-02"}, "2027-05": {"cierre": "2027-05-19", "vto": "2027-06-02"}, "2027-06": {"cierre": "2027-06-19", "vto": "2027-07-02"}}, "MG": {"2026-01": {"cierre": "2026-01-26", "vto": "2026-02-06"}, "2026-02": {"cierre": "2026-02-26", "vto": "2026-03-06"}, "2026-03": {"cierre": "2026-03-26", "vto": "2026-04-06"}, "2026-04": {"cierre": "2026-04-26", "vto": "2026-05-06"}, "2026-05": {"cierre": "2026-05-26", "vto": "2026-06-06"}, "2026-06": {"cierre": "2026-06-26", "vto": "2026-07-06"}, "2026-07": {"cierre": "2026-07-26", "vto": "2026-08-06"}, "2026-08": {"cierre": "2026-08-26", "vto": "2026-09-06"}, "2026-09": {"cierre": "2026-09-26", "vto": "2026-10-06"}, "2026-10": {"cierre": "2026-10-26", "vto": "2026-11-06"}, "2026-11": {"cierre": "2026-11-26", "vto": "2026-12-06"}, "2026-12": {"cierre": "2026-12-26", "vto": "2027-01-06"}, "2027-01": {"cierre": "2027-01-26", "vto": "2027-02-06"}, "2027-02": {"cierre": "2027-02-26", "vto": "2027-03-06"}, "2027-03": {"cierre": "2027-03-26", "vto": "2027-04-06"}, "2027-04": {"cierre": "2027-04-26", "vto": "2027-05-06"}, "2027-05": {"cierre": "2027-05-26", "vto": "2027-06-06"}, "2027-06": {"cierre": "2027-06-26", "vto": "2027-07-06"}}, "MN": {"2026-01": {"cierre": "2026-01-19", "vto": "2026-02-04"}, "2026-02": {"cierre": "2026-02-19", "vto": "2026-03-04"}, "2026-03": {"cierre": "2026-03-19", "vto": "2026-04-04"}, "2026-04": {"cierre": "2026-04-19", "vto": "2026-05-04"}, "2026-05": {"cierre": "2026-05-19", "vto": "2026-06-04"}, "2026-06": {"cierre": "2026-06-19", "vto": "2026-07-04"}, "2026-07": {"cierre": "2026-07-19", "vto": "2026-08-04"}, "2026-08": {"cierre": "2026-08-19", "vto": "2026-09-04"}, "2026-09": {"cierre": "2026-09-19", "vto": "2026-10-04"}, "2026-10": {"cierre": "2026-10-19", "vto": "2026-11-04"}, "2026-11": {"cierre": "2026-11-19", "vto": "2026-12-04"}, "2026-12": {"cierre": "2026-12-19", "vto": "2027-01-04"}, "2027-01": {"cierre": "2027-01-19", "vto": "2027-02-04"}, "2027-02": {"cierre": "2027-02-19", "vto": "2027-03-04"}, "2027-03": {"cierre": "2027-03-19", "vto": "2027-04-04"}, "2027-04": {"cierre": "2027-04-19", "vto": "2027-05-04"}, "2027-05": {"cierre": "2027-05-19", "vto": "2027-06-04"}, "2027-06": {"cierre": "2027-06-19", "vto": "2027-07-04"}}, "VM": {"2026-01": {"cierre": "2026-01-26", "vto": "2026-02-06"}, "2026-02": {"cierre": "2026-02-26", "vto": "2026-03-06"}, "2026-03": {"cierre": "2026-03-26", "vto": "2026-04-06"}, "2026-04": {"cierre": "2026-04-26", "vto": "2026-05-06"}, "2026-05": {"cierre": "2026-05-26", "vto": "2026-06-06"}, "2026-06": {"cierre": "2026-06-26", "vto": "2026-07-06"}, "2026-07": {"cierre": "2026-07-26", "vto": "2026-08-06"}, "2026-08": {"cierre": "2026-08-26", "vto": "2026-09-06"}, "2026-09": {"cierre": "2026-09-26", "vto": "2026-10-06"}, "2026-10": {"cierre": "2026-10-26", "vto": "2026-11-06"}, "2026-11": {"cierre": "2026-11-26", "vto": "2026-12-06"}, "2026-12": {"cierre": "2026-12-26", "vto": "2027-01-06"}, "2027-01": {"cierre": "2027-01-26", "vto": "2027-02-06"}, "2027-02": {"cierre": "2027-02-26", "vto": "2027-03-06"}, "2027-03": {"cierre": "2027-03-26", "vto": "2027-04-06"}, "2027-04": {"cierre": "2027-04-26", "vto": "2027-05-06"}, "2027-05": {"cierre": "2027-05-26", "vto": "2027-06-06"}, "2027-06": {"cierre": "2027-06-26", "vto": "2027-07-06"}}, "AE": {"2026-01": {"cierre": "2026-01-10", "vto": "2026-01-16"}, "2026-02": {"cierre": "2026-02-10", "vto": "2026-02-16"}, "2026-03": {"cierre": "2026-03-10", "vto": "2026-03-16"}, "2026-04": {"cierre": "2026-04-10", "vto": "2026-04-16"}, "2026-05": {"cierre": "2026-05-10", "vto": "2026-05-16"}, "2026-06": {"cierre": "2026-06-10", "vto": "2026-06-16"}, "2026-07": {"cierre": "2026-07-10", "vto": "2026-07-16"}, "2026-08": {"cierre": "2026-08-10", "vto": "2026-08-16"}, "2026-09": {"cierre": "2026-09-10", "vto": "2026-09-16"}, "2026-10": {"cierre": "2026-10-10", "vto": "2026-10-16"}, "2026-11": {"cierre": "2026-11-10", "vto": "2026-11-16"}, "2026-12": {"cierre": "2026-12-10", "vto": "2026-12-16"}, "2027-01": {"cierre": "2027-01-10", "vto": "2027-01-16"}, "2027-02": {"cierre": "2027-02-10", "vto": "2027-02-16"}, "2027-03": {"cierre": "2027-03-10", "vto": "2027-03-16"}, "2027-04": {"cierre": "2027-04-10", "vto": "2027-04-16"}, "2027-05": {"cierre": "2027-05-10", "vto": "2027-05-16"}, "2027-06": {"cierre": "2027-06-10", "vto": "2027-06-16"}}, "AM": {"2026-01": {"cierre": "2026-01-26", "vto": "2026-02-06"}, "2026-02": {"cierre": "2026-02-26", "vto": "2026-03-06"}, "2026-03": {"cierre": "2026-03-26", "vto": "2026-04-06"}, "2026-04": {"cierre": "2026-04-26", "vto": "2026-05-06"}, "2026-05": {"cierre": "2026-05-26", "vto": "2026-06-06"}, "2026-06": {"cierre": "2026-06-26", "vto": "2026-07-06"}, "2026-07": {"cierre": "2026-07-26", "vto": "2026-08-06"}, "2026-08": {"cierre": "2026-08-26", "vto": "2026-09-06"}, "2026-09": {"cierre": "2026-09-26", "vto": "2026-10-06"}, "2026-10": {"cierre": "2026-10-26", "vto": "2026-11-06"}, "2026-11": {"cierre": "2026-11-26", "vto": "2026-12-06"}, "2026-12": {"cierre": "2026-12-26", "vto": "2027-01-06"}, "2027-01": {"cierre": "2027-01-26", "vto": "2027-02-06"}, "2027-02": {"cierre": "2027-02-26", "vto": "2027-03-06"}, "2027-03": {"cierre": "2027-03-26", "vto": "2027-04-06"}, "2027-04": {"cierre": "2027-04-26", "vto": "2027-05-06"}, "2027-05": {"cierre": "2027-05-26", "vto": "2027-06-06"}, "2027-06": {"cierre": "2027-06-26", "vto": "2027-07-06"}}, "VGD": {"2026-01": {"cierre": "2026-01-19", "vto": "2026-02-02"}, "2026-02": {"cierre": "2026-02-19", "vto": "2026-03-02"}, "2026-03": {"cierre": "2026-03-19", "vto": "2026-04-02"}, "2026-04": {"cierre": "2026-04-19", "vto": "2026-05-02"}, "2026-05": {"cierre": "2026-05-19", "vto": "2026-06-02"}, "2026-06": {"cierre": "2026-06-19", "vto": "2026-07-02"}, "2026-07": {"cierre": "2026-07-19", "vto": "2026-08-02"}, "2026-08": {"cierre": "2026-08-19", "vto": "2026-09-02"}, "2026-09": {"cierre": "2026-09-19", "vto": "2026-10-02"}, "2026-10": {"cierre": "2026-10-19", "vto": "2026-11-02"}, "2026-11": {"cierre": "2026-11-19", "vto": "2026-12-02"}, "2026-12": {"cierre": "2026-12-19", "vto": "2027-01-02"}, "2027-01": {"cierre": "2027-01-19", "vto": "2027-02-02"}, "2027-02": {"cierre": "2027-02-19", "vto": "2027-03-02"}, "2027-03": {"cierre": "2027-03-19", "vto": "2027-04-02"}, "2027-04": {"cierre": "2027-04-19", "vto": "2027-05-02"}, "2027-05": {"cierre": "2027-05-19", "vto": "2027-06-02"}, "2027-06": {"cierre": "2027-06-19", "vto": "2027-07-02"}}, "MGD": {"2026-01": {"cierre": "2026-01-26", "vto": "2026-02-06"}, "2026-02": {"cierre": "2026-02-26", "vto": "2026-03-06"}, "2026-03": {"cierre": "2026-03-26", "vto": "2026-04-06"}, "2026-04": {"cierre": "2026-04-26", "vto": "2026-05-06"}, "2026-05": {"cierre": "2026-05-26", "vto": "2026-06-06"}, "2026-06": {"cierre": "2026-06-26", "vto": "2026-07-06"}, "2026-07": {"cierre": "2026-07-26", "vto": "2026-08-06"}, "2026-08": {"cierre": "2026-08-26", "vto": "2026-09-06"}, "2026-09": {"cierre": "2026-09-26", "vto": "2026-10-06"}, "2026-10": {"cierre": "2026-10-26", "vto": "2026-11-06"}, "2026-11": {"cierre": "2026-11-26", "vto": "2026-12-06"}, "2026-12": {"cierre": "2026-12-26", "vto": "2027-01-06"}, "2027-01": {"cierre": "2027-01-26", "vto": "2027-02-06"}, "2027-02": {"cierre": "2027-02-26", "vto": "2027-03-06"}, "2027-03": {"cierre": "2027-03-26", "vto": "2027-04-06"}, "2027-04": {"cierre": "2027-04-26", "vto": "2027-05-06"}, "2027-05": {"cierre": "2027-05-26", "vto": "2027-06-06"}, "2027-06": {"cierre": "2027-06-26", "vto": "2027-07-06"}}, "VFD": {"2026-01": {"cierre": "2026-01-26", "vto": "2026-02-06"}, "2026-02": {"cierre": "2026-02-26", "vto": "2026-03-06"}, "2026-03": {"cierre": "2026-03-26", "vto": "2026-04-06"}, "2026-04": {"cierre": "2026-04-26", "vto": "2026-05-06"}, "2026-05": {"cierre": "2026-05-26", "vto": "2026-06-06"}, "2026-06": {"cierre": "2026-06-26", "vto": "2026-07-06"}, "2026-07": {"cierre": "2026-07-26", "vto": "2026-08-06"}, "2026-08": {"cierre": "2026-08-26", "vto": "2026-09-06"}, "2026-09": {"cierre": "2026-09-26", "vto": "2026-10-06"}, "2026-10": {"cierre": "2026-10-26", "vto": "2026-11-06"}, "2026-11": {"cierre": "2026-11-26", "vto": "2026-12-06"}, "2026-12": {"cierre": "2026-12-26", "vto": "2027-01-06"}, "2027-01": {"cierre": "2027-01-26", "vto": "2027-02-06"}, "2027-02": {"cierre": "2027-02-26", "vto": "2027-03-06"}, "2027-03": {"cierre": "2027-03-26", "vto": "2027-04-06"}, "2027-04": {"cierre": "2027-04-26", "vto": "2027-05-06"}, "2027-05": {"cierre": "2027-05-26", "vto": "2027-06-06"}, "2027-06": {"cierre": "2027-06-26", "vto": "2027-07-06"}}};
function fmt(n){return'$'+Math.round(n).toLocaleString('es-AR');}
function getCatGrupo(cat,grupos){for(const g of grupos){if(g.cats.includes(cat))return g;}return null;}
function getCatColor(cat,grupos){const g=getCatGrupo(cat,grupos);if(!g)return'#94a3b8';const idx=g.cats.indexOf(cat);const cols=COLORES[g.id]||COLORES.variable;return cols[idx%cols.length];}
function calcularMesResumen(fechaStr,tarjetaId,periodos){
  if(!tarjetaId||!periodos||!periodos[tarjetaId])return fechaStr.slice(0,7);
  const fg=new Date(fechaStr+'T12:00:00');
  const sorted=Object.entries(periodos[tarjetaId]).map(([m,p])=>(({cierre:new Date(p.cierre+'T12:00:00'),cierreStr:p.cierre,vtoStr:p.vto}))).sort((a,b)=>a.cierre-b.cierre);
  for(const p of sorted){if(fg<=p.cierre)return p.vtoStr.slice(0,7);}
  const last=sorted[sorted.length-1];return last?last.vtoStr.slice(0,7):fechaStr.slice(0,7);
}
function getCierreInfo(fechaStr,tarjetaId,periodos){
  if(!tarjetaId||!periodos||!periodos[tarjetaId])return null;
  const fg=new Date(fechaStr+'T12:00:00');
  const sorted=Object.entries(periodos[tarjetaId]).map(([m,p])=>(({cierre:new Date(p.cierre+'T12:00:00'),cierreStr:p.cierre,vtoStr:p.vto}))).sort((a,b)=>a.cierre-b.cierre);
  for(const p of sorted){if(fg<=p.cierre)return p;}
  return sorted[sorted.length-1]||null;
}

const BRUTOS = [{"id": 1000, "fecha": "2026-01-05", "tipo": "gasto", "monto": 37562.0, "moneda": "ARS", "categoria": "Turismo", "cuenta": "VG", "desc": "Pinamar beach resort", "quien": "Leo", "cuotaActual": 9, "cuotaTotal": 12, "esCuota": true}, {"id": 1001, "fecha": "2026-01-05", "tipo": "gasto", "monto": 68000.0, "moneda": "ARS", "categoria": "Matr√≠cula Provincial", "cuenta": "VG", "desc": "VG", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1002, "fecha": "2026-01-05", "tipo": "gasto", "monto": 14200.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "VG", "desc": "Havanna", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1003, "fecha": "2026-01-05", "tipo": "gasto", "monto": 7158.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VG", "desc": "Aerolineas argentinas a CABA", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1004, "fecha": "2026-01-05", "tipo": "gasto", "monto": 87400.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VG", "desc": "Trenes argentinos", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1005, "fecha": "2026-01-05", "tipo": "gasto", "monto": 58877.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "VG", "desc": "Disco", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1006, "fecha": "2026-01-05", "tipo": "gasto", "monto": 15160.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "VG", "desc": "Atilios", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1007, "fecha": "2026-01-05", "tipo": "gasto", "monto": 22640.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "VG", "desc": "Acto Noah", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1008, "fecha": "2026-01-05", "tipo": "gasto", "monto": 47797.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "VG", "desc": "Verduleria", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1009, "fecha": "2026-01-05", "tipo": "gasto", "monto": 10180.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "VG", "desc": "Anco", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1010, "fecha": "2026-01-05", "tipo": "gasto", "monto": 15480.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "VG", "desc": "Kalimera", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1011, "fecha": "2026-01-05", "tipo": "gasto", "monto": 14980.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "VG", "desc": "Atilios", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1012, "fecha": "2026-01-05", "tipo": "gasto", "monto": 4573.0, "moneda": "ARS", "categoria": "Suscripciones", "cuenta": "VG", "desc": "Spotify", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1013, "fecha": "2026-01-05", "tipo": "gasto", "monto": 15530.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "VG", "desc": "Tostado", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1014, "fecha": "2026-01-05", "tipo": "gasto", "monto": 7299.0, "moneda": "ARS", "categoria": "Suscripciones", "cuenta": "VG", "desc": "Meli", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1015, "fecha": "2026-01-05", "tipo": "gasto", "monto": 25500.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "VG", "desc": "Blanca Cafe", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1016, "fecha": "2026-01-05", "tipo": "gasto", "monto": 52772.0, "moneda": "ARS", "categoria": "Monotributo/IIBB", "cuenta": "VG", "desc": "VG", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1017, "fecha": "2026-01-05", "tipo": "gasto", "monto": 6100.0, "moneda": "ARS", "categoria": "Gastos financieros", "cuenta": "", "desc": "Impuesto sello", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1018, "fecha": "2026-01-05", "tipo": "gasto", "monto": 30000.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "MN", "desc": "YPF", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1019, "fecha": "2026-01-05", "tipo": "gasto", "monto": 63906.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "MN", "desc": "Disco", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1020, "fecha": "2026-01-05", "tipo": "gasto", "monto": 50000.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "MN", "desc": "MN", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1021, "fecha": "2026-01-05", "tipo": "gasto", "monto": 10525.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MN", "desc": "Yenny", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1022, "fecha": "2026-01-05", "tipo": "gasto", "monto": 61111.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MN", "desc": "Lavasecarropas", "quien": "Leo", "cuotaActual": 13, "cuotaTotal": 18, "esCuota": true}, {"id": 1023, "fecha": "2026-01-05", "tipo": "gasto", "monto": 104235.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "MN", "desc": "Neumaticos", "quien": "Leo", "cuotaActual": 12, "cuotaTotal": 12, "esCuota": true}, {"id": 1024, "fecha": "2026-01-05", "tipo": "gasto", "monto": 41478.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "MN", "desc": "Aerolineas argentinas a CABA", "quien": "Leo", "cuotaActual": 10, "cuotaTotal": 12, "esCuota": true}, {"id": 1025, "fecha": "2026-01-05", "tipo": "gasto", "monto": 35809.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "MN", "desc": "Service", "quien": "Leo", "cuotaActual": 4, "cuotaTotal": 6, "esCuota": true}, {"id": 1026, "fecha": "2026-01-05", "tipo": "gasto", "monto": 5371.0, "moneda": "ARS", "categoria": "Gastos financieros", "cuenta": "", "desc": "Impuesto sello", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1027, "fecha": "2026-01-05", "tipo": "gasto", "monto": 39511.0, "moneda": "ARS", "categoria": "Gastos financieros", "cuenta": "", "desc": "intereses", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1028, "fecha": "2026-01-03", "tipo": "gasto", "monto": 81200.0, "moneda": "ARS", "categoria": "Empleada", "cuenta": "", "desc": "Del 29 al 2", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1029, "fecha": "2026-01-02", "tipo": "gasto", "monto": 32500.0, "moneda": "ARS", "categoria": "Farmacia", "cuenta": "", "desc": "t4 y calcio", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1030, "fecha": "2026-01-03", "tipo": "gasto", "monto": 36000.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "", "desc": "Almuerzo Gonza", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1031, "fecha": "2026-01-03", "tipo": "gasto", "monto": 24000.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "", "desc": "Encuentro Illia", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1032, "fecha": "2026-01-04", "tipo": "gasto", "monto": 21000.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "", "desc": "padel", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1033, "fecha": "2026-01-04", "tipo": "gasto", "monto": 3000.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "", "desc": "mago de los globos", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1034, "fecha": "2026-01-09", "tipo": "gasto", "monto": 30000.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "MG", "desc": "Cafe Puerto Blest", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1035, "fecha": "2026-01-09", "tipo": "gasto", "monto": 120469.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "MG", "desc": "Disco", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1036, "fecha": "2026-01-09", "tipo": "gasto", "monto": 5440.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "MG", "desc": "Dia", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1037, "fecha": "2026-01-09", "tipo": "gasto", "monto": 26980.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "MG", "desc": "Campo Verde", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1038, "fecha": "2026-01-09", "tipo": "gasto", "monto": 45758.0, "moneda": "ARS", "categoria": "Farmacia", "cuenta": "MG", "desc": "Cremas en bauza", "quien": "Leo", "cuotaActual": 1, "cuotaTotal": 3, "esCuota": true}, {"id": 1039, "fecha": "2026-01-09", "tipo": "gasto", "monto": 7070.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MG", "desc": "Mimo", "quien": "Leo", "cuotaActual": 2, "cuotaTotal": 6, "esCuota": true}, {"id": 1040, "fecha": "2026-01-13", "tipo": "gasto", "monto": 4600.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "AE", "desc": "Uber", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1041, "fecha": "2026-01-13", "tipo": "gasto", "monto": 38500.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "AE", "desc": "Caldo Rotiseria", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1042, "fecha": "2026-01-13", "tipo": "gasto", "monto": 31300.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "AE", "desc": "Lobito", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1043, "fecha": "2026-01-13", "tipo": "gasto", "monto": 14318.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "AE", "desc": "Aerolineas Argentinas", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1044, "fecha": "2026-01-13", "tipo": "gasto", "monto": 26000.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "AE", "desc": "Cafe Puerto Blest", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1045, "fecha": "2026-01-13", "tipo": "gasto", "monto": 5490.0, "moneda": "ARS", "categoria": "Suscripciones", "cuenta": "AE", "desc": "Pedidos ya plus", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1046, "fecha": "2026-01-13", "tipo": "gasto", "monto": 79400.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "AE", "desc": "Hard Rock Cafe", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1047, "fecha": "2026-01-13", "tipo": "gasto", "monto": 4305.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "AE", "desc": "Uber", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1048, "fecha": "2026-01-13", "tipo": "gasto", "monto": 5000.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "AE", "desc": "Estacionamiento Miramar", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1049, "fecha": "2026-01-13", "tipo": "gasto", "monto": 2507.0, "moneda": "ARS", "categoria": "Gastos financieros", "cuenta": "", "desc": "Impuesto sello", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1050, "fecha": "2026-01-08", "tipo": "gasto", "monto": 3398.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VM", "desc": "Cabify", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1051, "fecha": "2026-01-08", "tipo": "gasto", "monto": 1978.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VM", "desc": "Sube", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1052, "fecha": "2026-01-08", "tipo": "gasto", "monto": 78300.0, "moneda": "ARS", "categoria": "Gimnasio", "cuenta": "VM", "desc": "SportClub", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1053, "fecha": "2026-01-08", "tipo": "gasto", "monto": 38308.0, "moneda": "ARS", "categoria": "Luz", "cuenta": "VM", "desc": "Edea Di", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1054, "fecha": "2026-01-08", "tipo": "gasto", "monto": 11937.0, "moneda": "ARS", "categoria": "Gastos financieros", "cuenta": "", "desc": "Impuesto sello", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1055, "fecha": "2026-01-08", "tipo": "gasto", "monto": 19727.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VM", "desc": "Aerolineas Argentinas", "quien": "Leo", "cuotaActual": 13, "cuotaTotal": 18, "esCuota": true}, {"id": 1056, "fecha": "2026-01-08", "tipo": "gasto", "monto": 41970.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "VM", "desc": "Equus", "quien": "Leo", "cuotaActual": 2, "cuotaTotal": 6, "esCuota": true}, {"id": 1057, "fecha": "2026-01-08", "tipo": "gasto", "monto": 13500.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "VM", "desc": "Blanco del Once", "quien": "Leo", "cuotaActual": 6, "cuotaTotal": 6, "esCuota": true}, {"id": 1058, "fecha": "2026-01-09", "tipo": "gasto", "monto": 12601.0, "moneda": "ARS", "categoria": "Suscripciones", "cuenta": "MG", "desc": "Apple TV", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1059, "fecha": "2026-01-09", "tipo": "gasto", "monto": 2829.0, "moneda": "ARS", "categoria": "Gastos financieros", "cuenta": "", "desc": "Impuesto sello", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1060, "fecha": "2026-01-09", "tipo": "gasto", "monto": 18000.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "", "desc": "Vianda colonia", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1061, "fecha": "2026-01-09", "tipo": "gasto", "monto": 95360.0, "moneda": "ARS", "categoria": "Guitarra Noah", "cuenta": "", "desc": "Noviembre y diciembre 64USD", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1062, "fecha": "2026-01-09", "tipo": "gasto", "monto": 9000.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "", "desc": "Chubut cash.", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1063, "fecha": "2026-01-06", "tipo": "gasto", "monto": 4500.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "kersen dayu", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1064, "fecha": "2026-01-06", "tipo": "gasto", "monto": 22500.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "", "desc": "mercalito", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1065, "fecha": "2026-01-06", "tipo": "gasto", "monto": 18000.0, "moneda": "ARS", "categoria": "Farmacia", "cuenta": "", "desc": "pa√±ales", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1066, "fecha": "2026-01-07", "tipo": "gasto", "monto": 22000.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "", "desc": "birra con pibas", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1067, "fecha": "2026-01-07", "tipo": "gasto", "monto": 40000.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "", "desc": "almuerzo oli", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1068, "fecha": "2026-01-07", "tipo": "gasto", "monto": 6400.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "atelier", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1069, "fecha": "2026-01-07", "tipo": "gasto", "monto": 71500.0, "moneda": "ARS", "categoria": "Empleada", "cuenta": "", "desc": "4 al 7", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1070, "fecha": "2026-01-08", "tipo": "gasto", "monto": 38086.0, "moneda": "ARS", "categoria": "Luz", "cuenta": "VM", "desc": "Edea Nov", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1071, "fecha": "2026-01-08", "tipo": "gasto", "monto": 35000.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "VM", "desc": "Stage", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1072, "fecha": "2026-01-08", "tipo": "gasto", "monto": 56530.0, "moneda": "ARS", "categoria": "Internet/Cable", "cuenta": "VM", "desc": "Flow Di", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1073, "fecha": "2026-01-08", "tipo": "gasto", "monto": 7836.0, "moneda": "ARS", "categoria": "Suscripciones", "cuenta": "VM", "desc": "Prime Video", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1074, "fecha": "2026-01-08", "tipo": "gasto", "monto": 345000.0, "moneda": "ARS", "categoria": "Jard√≠n Noah", "cuenta": "VM", "desc": "Idra", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1075, "fecha": "2026-01-08", "tipo": "gasto", "monto": 21483.0, "moneda": "ARS", "categoria": "Gas", "cuenta": "VM", "desc": "Camuzzi Di", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1076, "fecha": "2026-01-08", "tipo": "gasto", "monto": 85004.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VM", "desc": "YPF", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1077, "fecha": "2026-01-08", "tipo": "gasto", "monto": 5198.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VM", "desc": "Aubasa", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1078, "fecha": "2026-01-08", "tipo": "gasto", "monto": 203381.0, "moneda": "ARS", "categoria": "Seguros", "cuenta": "VM", "desc": "Mercantil Andina", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1079, "fecha": "2026-01-08", "tipo": "gasto", "monto": 400000.0, "moneda": "ARS", "categoria": "Alquiler", "cuenta": "", "desc": "Blanco", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1080, "fecha": "2026-01-08", "tipo": "gasto", "monto": 622000.0, "moneda": "ARS", "categoria": "Alquiler", "cuenta": "", "desc": "Pesos", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1081, "fecha": "2026-01-08", "tipo": "gasto", "monto": 730000.0, "moneda": "ARS", "categoria": "Alquiler", "cuenta": "", "desc": "500 USD", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1082, "fecha": "2026-01-09", "tipo": "gasto", "monto": 4400.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "kersen", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1083, "fecha": "2026-01-10", "tipo": "gasto", "monto": 36600.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "", "desc": "desayuno merci", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1084, "fecha": "2026-01-10", "tipo": "gasto", "monto": 9800.0, "moneda": "ARS", "categoria": "Farmacia", "cuenta": "", "desc": "pa√±ales", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1085, "fecha": "2026-01-10", "tipo": "gasto", "monto": 28000.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "", "desc": "helado caballo loco", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1086, "fecha": "2026-01-11", "tipo": "gasto", "monto": 10000.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "Merci", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1087, "fecha": "2026-01-11", "tipo": "gasto", "monto": 20000.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "Chipa", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1088, "fecha": "2026-01-11", "tipo": "gasto", "monto": 12000.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "", "desc": "Atun", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1089, "fecha": "2026-01-12", "tipo": "gasto", "monto": 20500.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "", "desc": "Pescaderia", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1090, "fecha": "2026-01-12", "tipo": "gasto", "monto": 12200.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "", "desc": "Anco", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1091, "fecha": "2026-01-12", "tipo": "gasto", "monto": 4400.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "", "desc": "Shampoo", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1092, "fecha": "2026-01-12", "tipo": "gasto", "monto": 14700.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "Kersen", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1093, "fecha": "2026-01-12", "tipo": "gasto", "monto": 104000.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "", "desc": "jabad", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1094, "fecha": "2026-01-12", "tipo": "gasto", "monto": 290000.0, "moneda": "ARS", "categoria": "Dayu", "cuenta": "", "desc": "Dayu", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1095, "fecha": "2026-01-13", "tipo": "gasto", "monto": 61000.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "", "desc": "Cafe batuta 1k", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1096, "fecha": "2026-01-14", "tipo": "gasto", "monto": 4500.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "kersen", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1097, "fecha": "2026-01-15", "tipo": "gasto", "monto": 11200.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "", "desc": "almacen", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1098, "fecha": "2026-01-15", "tipo": "gasto", "monto": 6000.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "", "desc": "colonia jabad", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1099, "fecha": "2026-01-16", "tipo": "gasto", "monto": 13000.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "Cafe y helado", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1100, "fecha": "2026-01-16", "tipo": "gasto", "monto": 100000.0, "moneda": "ARS", "categoria": "Alquiler", "cuenta": "", "desc": "expensas", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1101, "fecha": "2026-01-16", "tipo": "gasto", "monto": 60000.0, "moneda": "ARS", "categoria": "Agua", "cuenta": "", "desc": "osse enero", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1102, "fecha": "2026-01-16", "tipo": "gasto", "monto": 117000.0, "moneda": "ARS", "categoria": "Empleada", "cuenta": "", "desc": "12 al 16", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1103, "fecha": "2026-01-16", "tipo": "gasto", "monto": 4000.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "", "desc": "estacionamiento", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1104, "fecha": "2026-01-17", "tipo": "gasto", "monto": 44000.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "", "desc": "Da filipo", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1105, "fecha": "2026-01-19", "tipo": "gasto", "monto": 28000.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "", "desc": "Campo verde", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1106, "fecha": "2026-01-18", "tipo": "gasto", "monto": 9500.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "", "desc": "Mercalito", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1107, "fecha": "2026-01-20", "tipo": "gasto", "monto": 4500.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "kersen", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1108, "fecha": "2026-01-20", "tipo": "gasto", "monto": 23000.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "", "desc": "batata", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1109, "fecha": "2026-01-21", "tipo": "gasto", "monto": 10200.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "", "desc": "salad break", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1110, "fecha": "2026-01-22", "tipo": "gasto", "monto": 20000.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "", "desc": "chirimollo", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1111, "fecha": "2026-01-22", "tipo": "gasto", "monto": 10400.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "", "desc": "caldo empanadas", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1112, "fecha": "2026-01-22", "tipo": "gasto", "monto": 5000.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "", "desc": "patsonia", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1113, "fecha": "2026-01-22", "tipo": "gasto", "monto": 72000.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "", "desc": "mochila dayu", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1114, "fecha": "2026-01-22", "tipo": "gasto", "monto": 60000.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "", "desc": "fotos", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1115, "fecha": "2026-01-24", "tipo": "gasto", "monto": 26000.0, "moneda": "ARS", "categoria": "Farmacia", "cuenta": "", "desc": "pa√±ales", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1116, "fecha": "2026-01-24", "tipo": "gasto", "monto": 14000.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "", "desc": "propina socarrat", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1117, "fecha": "2026-01-24", "tipo": "gasto", "monto": 5000.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "miramar", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1118, "fecha": "2026-01-27", "tipo": "gasto", "monto": 4000.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "prota", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1119, "fecha": "2026-01-28", "tipo": "gasto", "monto": 4300.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "", "desc": "cabify", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1120, "fecha": "2026-01-28", "tipo": "gasto", "monto": 43000.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "", "desc": "Negra simona", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1121, "fecha": "2026-01-29", "tipo": "gasto", "monto": 8000.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "helga", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1122, "fecha": "2026-01-30", "tipo": "gasto", "monto": 20000.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "", "desc": "dietetica", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1123, "fecha": "2026-01-30", "tipo": "gasto", "monto": 2000.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "", "desc": "pan", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1124, "fecha": "2026-01-30", "tipo": "gasto", "monto": 110000.0, "moneda": "ARS", "categoria": "Empleada", "cuenta": "", "desc": "26 al 30", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1125, "fecha": "2026-01-31", "tipo": "gasto", "monto": 6200.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "", "desc": "Uber", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1126, "fecha": "2026-01-31", "tipo": "gasto", "monto": 50000.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "", "desc": "Lima Linda", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1127, "fecha": "2026-01-31", "tipo": "gasto", "monto": 16900.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "", "desc": "Dean and denis", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1128, "fecha": "2026-02-02", "tipo": "gasto", "monto": 41478.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "MN", "desc": "Aerolineas argentinas a CABA", "quien": "Leo", "cuotaActual": 11, "cuotaTotal": 12, "esCuota": true}, {"id": 1129, "fecha": "2026-02-02", "tipo": "gasto", "monto": 35809.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "MN", "desc": "Service", "quien": "Leo", "cuotaActual": 5, "cuotaTotal": 6, "esCuota": true}, {"id": 1130, "fecha": "2026-02-06", "tipo": "gasto", "monto": 7070.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MG", "desc": "Mimo", "quien": "Leo", "cuotaActual": 3, "cuotaTotal": 6, "esCuota": true}, {"id": 1131, "fecha": "2026-02-06", "tipo": "gasto", "monto": 19727.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VM", "desc": "Aerolineas Argentinas", "quien": "Leo", "cuotaActual": 14, "cuotaTotal": 18, "esCuota": true}, {"id": 1132, "fecha": "2026-02-06", "tipo": "gasto", "monto": 41970.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "VM", "desc": "Equus", "quien": "Leo", "cuotaActual": 3, "cuotaTotal": 6, "esCuota": true}, {"id": 1133, "fecha": "2026-02-02", "tipo": "gasto", "monto": 37562.0, "moneda": "ARS", "categoria": "Turismo", "cuenta": "VG", "desc": "Pinamar beach resort", "quien": "Leo", "cuotaActual": 10, "cuotaTotal": 12, "esCuota": true}, {"id": 1134, "fecha": "2026-02-06", "tipo": "gasto", "monto": 45758.0, "moneda": "ARS", "categoria": "Farmacia", "cuenta": "MG", "desc": "Cremas en bauza", "quien": "Leo", "cuotaActual": 2, "cuotaTotal": 3, "esCuota": true}, {"id": 1135, "fecha": "2026-02-04", "tipo": "gasto", "monto": 50000.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "MN", "desc": "Shell", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1136, "fecha": "2026-02-04", "tipo": "gasto", "monto": 18200.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "MN", "desc": "Miramar", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1137, "fecha": "2026-02-04", "tipo": "gasto", "monto": 172986.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "MN", "desc": "Disco", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1138, "fecha": "2026-02-04", "tipo": "gasto", "monto": 61111.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MN", "desc": "On City", "quien": "Leo", "cuotaActual": 14, "cuotaTotal": 18, "esCuota": true}, {"id": 1139, "fecha": "2026-02-02", "tipo": "gasto", "monto": 68000.0, "moneda": "ARS", "categoria": "Matr√≠cula Provincial", "cuenta": "VG", "desc": "Diciembre", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1140, "fecha": "2026-02-02", "tipo": "gasto", "monto": 11280.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "VG", "desc": "Anco", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1141, "fecha": "2026-02-02", "tipo": "gasto", "monto": 15990.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "VG", "desc": "Coronados", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1142, "fecha": "2026-02-02", "tipo": "gasto", "monto": 10990.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "VG", "desc": "Bocados Maestros", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1143, "fecha": "2026-02-02", "tipo": "gasto", "monto": 18399.0, "moneda": "ARS", "categoria": "Suscripciones", "cuenta": "VG", "desc": "Meli", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1144, "fecha": "2026-02-02", "tipo": "gasto", "monto": 11000.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "VG", "desc": "Anco", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1145, "fecha": "2026-02-02", "tipo": "gasto", "monto": 52772.0, "moneda": "ARS", "categoria": "Monotributo/IIBB", "cuenta": "VG", "desc": "VG", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1146, "fecha": "2026-02-06", "tipo": "gasto", "monto": 57554.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "MG", "desc": "Verduleria", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1147, "fecha": "2026-02-06", "tipo": "gasto", "monto": 80056.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "MG", "desc": "Verduleria", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1148, "fecha": "2026-02-06", "tipo": "gasto", "monto": 22550.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "MG", "desc": "La rapita", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1149, "fecha": "2026-02-06", "tipo": "gasto", "monto": 2556.0, "moneda": "ARS", "categoria": "Gastos financieros", "cuenta": "MG", "desc": "Impuesto sello", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1150, "fecha": "2026-02-06", "tipo": "gasto", "monto": 7853.0, "moneda": "ARS", "categoria": "Suscripciones", "cuenta": "VM", "desc": "Prime Video", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1151, "fecha": "2026-02-06", "tipo": "gasto", "monto": 58210.0, "moneda": "ARS", "categoria": "Suscripciones", "cuenta": "VM", "desc": "Personal Flow", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1152, "fecha": "2026-02-06", "tipo": "gasto", "monto": 18100.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "VM", "desc": "Aquaro", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1153, "fecha": "2026-02-06", "tipo": "gasto", "monto": 345000.0, "moneda": "ARS", "categoria": "Jard√≠n Noah", "cuenta": "VM", "desc": "Idra", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1154, "fecha": "2026-02-06", "tipo": "gasto", "monto": 21483.0, "moneda": "ARS", "categoria": "Gas", "cuenta": "VM", "desc": "Camuzzi Enero", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1155, "fecha": "2026-02-06", "tipo": "gasto", "monto": 205632.0, "moneda": "ARS", "categoria": "Seguros", "cuenta": "VM", "desc": "Seguro auto", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1156, "fecha": "2026-02-06", "tipo": "gasto", "monto": 78300.0, "moneda": "ARS", "categoria": "Gimnasio", "cuenta": "VM", "desc": "SportClub", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1157, "fecha": "2026-02-06", "tipo": "gasto", "monto": 14000.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "VM", "desc": "Almacen", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1158, "fecha": "2026-02-06", "tipo": "gasto", "monto": 100000.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VM", "desc": "YPF", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1159, "fecha": "2026-02-06", "tipo": "gasto", "monto": 1300.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VM", "desc": "Estacionamiento miramar", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1160, "fecha": "2026-02-06", "tipo": "gasto", "monto": 49499.0, "moneda": "ARS", "categoria": "Luz", "cuenta": "VM", "desc": "Edea Enero", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1161, "fecha": "2026-02-06", "tipo": "gasto", "monto": 14262.0, "moneda": "ARS", "categoria": "Gastos financieros", "cuenta": "VM", "desc": "Impuesto sello", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1162, "fecha": "2026-02-03", "tipo": "gasto", "monto": 10400.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "Kersen", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1163, "fecha": "2026-02-03", "tipo": "gasto", "monto": 27472.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "", "desc": "New Garden", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1164, "fecha": "2026-02-06", "tipo": "gasto", "monto": 120150.0, "moneda": "ARS", "categoria": "Empleada", "cuenta": "", "desc": "del 2 al 6", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1165, "fecha": "2026-02-06", "tipo": "gasto", "monto": 21000.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "", "desc": "little", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1166, "fecha": "2026-02-07", "tipo": "gasto", "monto": 29000.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "", "desc": "granja", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1167, "fecha": "2026-02-07", "tipo": "gasto", "monto": 8000.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "", "desc": "estacionamiento", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1168, "fecha": "2026-02-07", "tipo": "gasto", "monto": 43000.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "", "desc": "parque mogotes", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1169, "fecha": "2026-02-07", "tipo": "gasto", "monto": 42000.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "", "desc": "cena mogotes", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1170, "fecha": "2026-02-08", "tipo": "gasto", "monto": 9500.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "churros galles", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1171, "fecha": "2026-02-08", "tipo": "gasto", "monto": 8000.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "", "desc": "almacen", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1172, "fecha": "2026-02-11", "tipo": "gasto", "monto": 4900.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "", "desc": "cabify", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1173, "fecha": "2026-02-09", "tipo": "gasto", "monto": 1728000.0, "moneda": "ARS", "categoria": "Alquiler", "cuenta": "", "desc": "febrero", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1174, "fecha": "2026-02-13", "tipo": "gasto", "monto": 18000.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "Cafe budin agua", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1175, "fecha": "2026-02-14", "tipo": "gasto", "monto": 100000.0, "moneda": "ARS", "categoria": "Alquiler", "cuenta": "", "desc": "expensas", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1176, "fecha": "2026-02-14", "tipo": "gasto", "monto": 60000.0, "moneda": "ARS", "categoria": "Agua", "cuenta": "", "desc": "osse", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1177, "fecha": "2026-02-14", "tipo": "gasto", "monto": 110000.0, "moneda": "ARS", "categoria": "Empleada", "cuenta": "", "desc": "9 al 13", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1178, "fecha": "2026-02-15", "tipo": "gasto", "monto": 32000.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "", "desc": "Franks grill", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1179, "fecha": "2026-02-15", "tipo": "gasto", "monto": 25000.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "", "desc": "peluquer√≠a", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1180, "fecha": "2026-02-16", "tipo": "gasto", "monto": 13600.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "blanca", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1181, "fecha": "2026-02-16", "tipo": "gasto", "monto": 41000.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "", "desc": "blanca desayuno", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1182, "fecha": "2026-02-16", "tipo": "gasto", "monto": 14000.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "", "desc": "bote", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1183, "fecha": "2026-02-18", "tipo": "gasto", "monto": 50000.0, "moneda": "ARS", "categoria": "Supermercado", "cuenta": "", "desc": "verduleria", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1184, "fecha": "2026-02-19", "tipo": "gasto", "monto": 65000.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "", "desc": "torta cumple", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1185, "fecha": "2026-02-19", "tipo": "gasto", "monto": 49000.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "", "desc": "bebidas cumple", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1186, "fecha": "2026-02-20", "tipo": "gasto", "monto": 12500.0, "moneda": "ARS", "categoria": "Caf√©/Kiosko", "cuenta": "", "desc": "Cafe y barrita", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1187, "fecha": "2026-02-20", "tipo": "gasto", "monto": 3500.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "", "desc": "calesita", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1188, "fecha": "2026-02-21", "tipo": "gasto", "monto": 40000.0, "moneda": "ARS", "categoria": "Salidas", "cuenta": "", "desc": "merci", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1189, "fecha": "2026-02-22", "tipo": "gasto", "monto": 15000.0, "moneda": "ARS", "categoria": "Actividades", "cuenta": "", "desc": "batata", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1190, "fecha": "2026-02-22", "tipo": "gasto", "monto": 12000.0, "moneda": "ARS", "categoria": "Delivery", "cuenta": "", "desc": "viccini", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1191, "fecha": "2026-02-22", "tipo": "gasto", "monto": 3500.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "", "desc": "cinta", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"id": 1192, "fecha": "2026-02-20", "tipo": "gasto", "monto": 65000.0, "moneda": "ARS", "categoria": "Empleada", "cuenta": "", "desc": "del 15 al 20", "quien": "Leo", "cuotaActual": null, "cuotaTotal": null, "esCuota": false}, {"fecha": "2026-01-31", "tipo": "ingreso", "monto": 3230171, "moneda": "ARS", "categoria": "CENEMAR", "cuenta": "", "desc": "CENEMAR", "quien": "Leo", "esCuota": false, "esCuotaFutura": false, "mesResumen": "2026-01", "id": 9000}, {"fecha": "2026-01-31", "tipo": "ingreso", "monto": 236500, "moneda": "ARS", "categoria": "Escuela de Medicina", "cuenta": "", "desc": "ESM", "quien": "Leo", "esCuota": false, "esCuotaFutura": false, "mesResumen": "2026-01", "id": 9001}, {"fecha": "2026-01-31", "tipo": "ingreso", "monto": 732806, "moneda": "ARS", "categoria": "Consultorio", "cuenta": "", "desc": "Consultorio", "quien": "Leo", "esCuota": false, "esCuotaFutura": false, "mesResumen": "2026-01", "id": 9002}, {"fecha": "2026-01-31", "tipo": "ingreso", "monto": 400000, "moneda": "ARS", "categoria": "Alquiler cobrado", "cuenta": "", "desc": "Alquiler cobrado", "quien": "Leo", "esCuota": false, "esCuotaFutura": false, "mesResumen": "2026-01", "id": 9003}, {"fecha": "2026-01-31", "tipo": "ingreso", "monto": 720000, "moneda": "ARS", "categoria": "Beca Dayu", "cuenta": "", "desc": "Beca Dayu", "quien": "Leo", "esCuota": false, "esCuotaFutura": false, "mesResumen": "2026-01", "id": 9004}, {"fecha": "2026-01-31", "tipo": "ingreso", "monto": 202000, "moneda": "ARS", "categoria": "Promociones/Cashback", "cuenta": "", "desc": "Promociones/Cashback", "quien": "Leo", "esCuota": false, "esCuotaFutura": false, "mesResumen": "2026-01", "id": 9005}, {"fecha": "2026-02-28", "tipo": "ingreso", "monto": 3280000, "moneda": "ARS", "categoria": "CENEMAR", "cuenta": "", "desc": "CENEMAR", "quien": "Leo", "esCuota": false, "esCuotaFutura": false, "mesResumen": "2026-02", "id": 9006}, {"fecha": "2026-02-28", "tipo": "ingreso", "monto": 249289, "moneda": "ARS", "categoria": "Escuela de Medicina", "cuenta": "", "desc": "ESM", "quien": "Leo", "esCuota": false, "esCuotaFutura": false, "mesResumen": "2026-02", "id": 9007}, {"fecha": "2026-02-28", "tipo": "ingreso", "monto": 791800, "moneda": "ARS", "categoria": "Consultorio", "cuenta": "", "desc": "Consultorio", "quien": "Leo", "esCuota": false, "esCuotaFutura": false, "mesResumen": "2026-02", "id": 9008}, {"fecha": "2026-02-28", "tipo": "ingreso", "monto": 400000, "moneda": "ARS", "categoria": "Alquiler cobrado", "cuenta": "", "desc": "Alquiler cobrado", "quien": "Leo", "esCuota": false, "esCuotaFutura": false, "mesResumen": "2026-02", "id": 9009}, {"fecha": "2026-02-28", "tipo": "ingreso", "monto": 720000, "moneda": "ARS", "categoria": "Beca Dayu", "cuenta": "", "desc": "Beca Dayu", "quien": "Leo", "esCuota": false, "esCuotaFutura": false, "mesResumen": "2026-02", "id": 9010}, {"fecha": "2026-02-28", "tipo": "ingreso", "monto": 55000, "moneda": "ARS", "categoria": "Promociones/Cashback", "cuenta": "", "desc": "Promociones/Cashback", "quien": "Leo", "esCuota": false, "esCuotaFutura": false, "mesResumen": "2026-02", "id": 9011}, {"id": 5000, "fecha": "2026-02-02", "tipo": "gasto", "monto": 37562.0, "moneda": "ARS", "categoria": "Turismo", "cuenta": "VG", "desc": "Pinamar beach resort ‚Äî cuota 11/12", "quien": "Leo", "cuotaActual": 11, "cuotaTotal": 12, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-04"}, {"id": 5001, "fecha": "2026-02-02", "tipo": "gasto", "monto": 37562.0, "moneda": "ARS", "categoria": "Turismo", "cuenta": "VG", "desc": "Pinamar beach resort ‚Äî cuota 12/12", "quien": "Leo", "cuotaActual": 12, "cuotaTotal": 12, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-05"}, {"id": 5002, "fecha": "2026-01-05", "tipo": "gasto", "monto": 61111.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MN", "desc": "Lavasecarropas ‚Äî cuota 14/18", "quien": "Leo", "cuotaActual": 14, "cuotaTotal": 18, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-03"}, {"id": 5003, "fecha": "2026-01-05", "tipo": "gasto", "monto": 61111.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MN", "desc": "Lavasecarropas ‚Äî cuota 15/18", "quien": "Leo", "cuotaActual": 15, "cuotaTotal": 18, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-04"}, {"id": 5004, "fecha": "2026-01-05", "tipo": "gasto", "monto": 61111.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MN", "desc": "Lavasecarropas ‚Äî cuota 16/18", "quien": "Leo", "cuotaActual": 16, "cuotaTotal": 18, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-05"}, {"id": 5005, "fecha": "2026-01-05", "tipo": "gasto", "monto": 61111.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MN", "desc": "Lavasecarropas ‚Äî cuota 17/18", "quien": "Leo", "cuotaActual": 17, "cuotaTotal": 18, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-06"}, {"id": 5006, "fecha": "2026-01-05", "tipo": "gasto", "monto": 61111.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MN", "desc": "Lavasecarropas ‚Äî cuota 18/18", "quien": "Leo", "cuotaActual": 18, "cuotaTotal": 18, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-07"}, {"id": 5007, "fecha": "2026-02-02", "tipo": "gasto", "monto": 41478.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "MN", "desc": "Aerolineas argentinas a CABA ‚Äî cuota 12/12", "quien": "Leo", "cuotaActual": 12, "cuotaTotal": 12, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-04"}, {"id": 5008, "fecha": "2026-02-02", "tipo": "gasto", "monto": 35809.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "MN", "desc": "Service ‚Äî cuota 6/6", "quien": "Leo", "cuotaActual": 6, "cuotaTotal": 6, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-04"}, {"id": 5009, "fecha": "2026-02-06", "tipo": "gasto", "monto": 45758.0, "moneda": "ARS", "categoria": "Farmacia", "cuenta": "MG", "desc": "Cremas en bauza ‚Äî cuota 3/3", "quien": "Leo", "cuotaActual": 3, "cuotaTotal": 3, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-04"}, {"id": 5010, "fecha": "2026-02-06", "tipo": "gasto", "monto": 7070.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MG", "desc": "Mimo ‚Äî cuota 4/6", "quien": "Leo", "cuotaActual": 4, "cuotaTotal": 6, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-04"}, {"id": 5011, "fecha": "2026-02-06", "tipo": "gasto", "monto": 7070.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MG", "desc": "Mimo ‚Äî cuota 5/6", "quien": "Leo", "cuotaActual": 5, "cuotaTotal": 6, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-05"}, {"id": 5012, "fecha": "2026-02-06", "tipo": "gasto", "monto": 7070.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MG", "desc": "Mimo ‚Äî cuota 6/6", "quien": "Leo", "cuotaActual": 6, "cuotaTotal": 6, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-06"}, {"id": 5013, "fecha": "2026-02-06", "tipo": "gasto", "monto": 19727.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VM", "desc": "Aerolineas Argentinas ‚Äî cuota 15/18", "quien": "Leo", "cuotaActual": 15, "cuotaTotal": 18, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-04"}, {"id": 5014, "fecha": "2026-02-06", "tipo": "gasto", "monto": 19727.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VM", "desc": "Aerolineas Argentinas ‚Äî cuota 16/18", "quien": "Leo", "cuotaActual": 16, "cuotaTotal": 18, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-05"}, {"id": 5015, "fecha": "2026-02-06", "tipo": "gasto", "monto": 19727.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VM", "desc": "Aerolineas Argentinas ‚Äî cuota 17/18", "quien": "Leo", "cuotaActual": 17, "cuotaTotal": 18, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-06"}, {"id": 5016, "fecha": "2026-02-06", "tipo": "gasto", "monto": 19727.0, "moneda": "ARS", "categoria": "Transporte", "cuenta": "VM", "desc": "Aerolineas Argentinas ‚Äî cuota 18/18", "quien": "Leo", "cuotaActual": 18, "cuotaTotal": 18, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-07"}, {"id": 5017, "fecha": "2026-02-06", "tipo": "gasto", "monto": 41970.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "VM", "desc": "Equus ‚Äî cuota 4/6", "quien": "Leo", "cuotaActual": 4, "cuotaTotal": 6, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-04"}, {"id": 5018, "fecha": "2026-02-06", "tipo": "gasto", "monto": 41970.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "VM", "desc": "Equus ‚Äî cuota 5/6", "quien": "Leo", "cuotaActual": 5, "cuotaTotal": 6, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-05"}, {"id": 5019, "fecha": "2026-02-06", "tipo": "gasto", "monto": 41970.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "VM", "desc": "Equus ‚Äî cuota 6/6", "quien": "Leo", "cuotaActual": 6, "cuotaTotal": 6, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-06"}, {"id": 5020, "fecha": "2026-02-04", "tipo": "gasto", "monto": 61111.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MN", "desc": "On City ‚Äî cuota 15/18", "quien": "Leo", "cuotaActual": 15, "cuotaTotal": 18, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-04"}, {"id": 5021, "fecha": "2026-02-04", "tipo": "gasto", "monto": 61111.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MN", "desc": "On City ‚Äî cuota 16/18", "quien": "Leo", "cuotaActual": 16, "cuotaTotal": 18, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-05"}, {"id": 5022, "fecha": "2026-02-04", "tipo": "gasto", "monto": 61111.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MN", "desc": "On City ‚Äî cuota 17/18", "quien": "Leo", "cuotaActual": 17, "cuotaTotal": 18, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-06"}, {"id": 5023, "fecha": "2026-02-04", "tipo": "gasto", "monto": 61111.0, "moneda": "ARS", "categoria": "Compras", "cuenta": "MN", "desc": "On City ‚Äî cuota 18/18", "quien": "Leo", "cuotaActual": 18, "cuotaTotal": 18, "esCuota": true, "esCuotaFutura": true, "mesResumen": "2026-07"}];

let datos=[], grupos=JSON.parse(JSON.stringify(GRUPOS_DEFAULT)), periodos=JSON.parse(JSON.stringify(PERIODOS_DEFAULT));
let mesDash='2026-02', mesCat='2026-02', mesRes='2026-03';
let migracionHecha=false;
let unsubMovs=null;

function setSyncStatus(txt,color='var(--text2)'){
  const el=document.getElementById('sync-status');
  if(el)el.innerHTML=`<span style="color:${color}">${txt}</span>`;
}

onAuthStateChanged(auth,user=>{
  if(user&&EMAILS_OK.includes(user.email)){
    document.getElementById('login-screen').style.display='none';
    document.getElementById('app').style.display='flex';
    document.getElementById('user-email').textContent=user.email;
    iniciarListeners();
  } else if(user){
    signOut(auth);
    const el=document.getElementById('login-error');el.textContent='Email no autorizado: '+user.email;el.style.display='block';
  } else {
    document.getElementById('login-screen').style.display='flex';
    document.getElementById('app').style.display='none';
    if(unsubMovs){unsubMovs();unsubMovs=null;}
  }
});

document.getElementById('btn-google-login').onclick=async()=>{
  try{await signInWithPopup(auth,provider);}
  catch(e){const el=document.getElementById('login-error');el.textContent='Error: '+e.message;el.style.display='block';}
};
window.cerrarSesion=()=>signOut(auth);

function iniciarListeners(){
  setSyncStatus('‚óè Conectando...','var(--accent3)');
  unsubMovs=onSnapshot(collection(db,'movimientos'),snap=>{
    datos=snap.docs.map(d=>{const data=d.data();return{...data,_fbId:d.id};});
    if(datos.length===0&&!migracionHecha){migracionHecha=true;migrarHistorico();}
    setSyncStatus('‚óè Sincronizado','var(--accent)');
    renderAll();
  },()=>setSyncStatus('‚óè Sin conexi√≥n','var(--danger)'));
  onSnapshot(doc(db,'config','grupos'),snap=>{if(snap.exists())grupos=snap.data().grupos;});
  onSnapshot(doc(db,'config','periodos'),snap=>{if(snap.exists())periodos=snap.data().periodos;});
}

async function migrarHistorico(){
  console.log('Migrando',BRUTOS.length,'movimientos...');
  const batch=BRUTOS.map(d=>addDoc(collection(db,'movimientos'),d));
  await Promise.all(batch);
  console.log('Migraci√≥n OK');
}

async function guardarConfig(){
  await setDoc(doc(db,'config','grupos'),{grupos});
  await setDoc(doc(db,'config','periodos'),{periodos});
}

// ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function getGastosImpacto(mes){return datos.filter(d=>d.tipo==='gasto'&&d.mesResumen===mes);}
function getMes(m){return datos.filter(d=>d.fecha&&d.fecha.startsWith(m));}
function getMeses(){return[...new Set(datos.filter(d=>d.fecha).map(d=>d.fecha.slice(0,7)))].sort();}
function getMesesResumen(){const s=new Set(datos.filter(d=>d.tipo==='gasto'&&d.mesResumen).map(d=>d.mesResumen));return[...s].sort();}
function quienBadge(q){return q==='Dayu'?`<span class="quien-badge quien-dayu">Dayu</span>`:`<span class="quien-badge quien-leo">Leo</span>`;}

function navTo(page,el){
  document.querySelectorAll('.page-section').forEach(p=>p.style.display='none');
  document.getElementById('page-'+page).style.display='block';
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  if(el)el.classList.add('active');
  renderAll();
}
window.navTo=navTo;

function renderAll(){
  renderMesTabs();renderKPIs();renderSplit();renderCharts();renderRecientes();
  renderMovimientos();renderResumenes();renderConfigTarjetas();renderCategorias();renderComparativa();renderConfig();
  actualizarCatsFiltro();
}

function renderMesTabs(){
  const meses=getMeses(),mesesRes=getMesesResumen();
  [['mes-tabs-dash',mesDash,'setMesDash'],['mes-tabs-cat',mesCat,'setMesCat']].forEach(([id,cur,fn])=>{
    const el=document.getElementById(id);if(!el)return;
    el.innerHTML=meses.map(m=>`<div class="mes-tab ${m===cur?'active':''}" onclick="window.${fn}('${m}')">${NOMBRES_MES[m]||m}</div>`).join('');
  });
  const elRes=document.getElementById('mes-tabs-res');
  if(elRes)elRes.innerHTML=mesesRes.map(m=>`<div class="mes-tab ${m===mesRes?'active':''}" onclick="window.setMesRes('${m}')">${NOMBRES_MES[m]||m}</div>`).join('');
}
window.setMesDash=m=>{mesDash=m;renderAll();};
window.setMesCat=m=>{mesCat=m;renderAll();};
window.setMesRes=m=>{mesRes=m;renderAll();};

function renderKPIs(){
  const ing=getMes(mesDash).filter(d=>d.tipo==='ingreso').reduce((s,d)=>s+d.monto,0);
  const gasReal=getGastosImpacto(mesDash).filter(d=>!d.esCuotaFutura).reduce((s,d)=>s+d.monto,0);
  const gasFuturo=getGastosImpacto(mesDash).filter(d=>d.esCuotaFutura).reduce((s,d)=>s+d.monto,0);
  const gasTotal=gasReal+gasFuturo;
  const fijo=getGastosImpacto(mesDash).filter(d=>getCatGrupo(d.categoria,grupos)?.id==='fijo').reduce((s,d)=>s+d.monto,0);
  const bal=ing-gasTotal;
  document.getElementById('kpis').innerHTML=`
    <div class="kpi green"><div class="kpi-label">Ingresos</div><div class="kpi-value" style="color:var(--accent)">${fmt(ing)}</div><div class="kpi-sub">del mes</div></div>
    <div class="kpi red"><div class="kpi-label">Gastos (impacto)</div><div class="kpi-value" style="color:var(--danger)">${fmt(gasTotal)}</div><div class="kpi-sub">${gasFuturo>0?`incl. ${fmt(gasFuturo)} en cuotas`:`${ing>0?Math.round(gasTotal/ing*100):0}% del ingreso`}</div></div>
    <div class="kpi blue"><div class="kpi-label">Gastos fijos</div><div class="kpi-value" style="color:var(--accent2)">${fmt(fijo)}</div><div class="kpi-sub">${gasTotal>0?Math.round(fijo/gasTotal*100):0}% del gasto</div></div>
    <div class="kpi ${bal>=0?'green':'red'}"><div class="kpi-label">Balance</div><div class="kpi-value" style="color:${bal>=0?'var(--accent)':'var(--danger)'}">${fmt(bal)}</div><div class="kpi-sub">${bal>=0?'‚úì Super√°vit':'‚ö† D√©ficit'}</div></div>`;
}

function renderSplit(){
  const mv=getGastosImpacto(mesDash);
  const f=mv.filter(d=>getCatGrupo(d.categoria,grupos)?.id==='fijo').reduce((s,d)=>s+d.monto,0);
  const v=mv.filter(d=>getCatGrupo(d.categoria,grupos)?.id==='variable').reduce((s,d)=>s+d.monto,0);
  const fi=mv.filter(d=>getCatGrupo(d.categoria,grupos)?.id==='financiero').reduce((s,d)=>s+d.monto,0);
  const t=f+v+fi||1;
  document.getElementById('split-cards').innerHTML=`
    <div class="split-card"><h4 style="color:var(--accent2)">üîµ Fijos</h4><div style="font-size:22px;font-weight:800;color:var(--accent2);letter-spacing:-1px">${fmt(f)}</div><div style="font-size:11px;font-family:'DM Mono',monospace;color:var(--text2);margin-top:4px">${Math.round(f/t*100)}%</div></div>
    <div class="split-card"><h4 style="color:var(--accent3)">üü° Variables</h4><div style="font-size:22px;font-weight:800;color:var(--accent3);letter-spacing:-1px">${fmt(v)}</div><div style="font-size:11px;font-family:'DM Mono',monospace;color:var(--text2);margin-top:4px">${Math.round(v/t*100)}%</div></div>
    <div class="split-card"><h4 style="color:#a78bfa">üü£ Fin/Salud</h4><div style="font-size:22px;font-weight:800;color:#a78bfa;letter-spacing:-1px">${fmt(fi)}</div><div style="font-size:11px;font-family:'DM Mono',monospace;color:var(--text2);margin-top:4px">${Math.round(fi/t*100)}%</div></div>`;
}

function renderCharts(){
  const mv=getGastosImpacto(mesDash).filter(d=>!d.esCuotaFutura);
  const cm={};mv.forEach(d=>{cm[d.categoria]=(cm[d.categoria]||0)+d.monto;});
  const sorted=Object.entries(cm).sort((a,b)=>b[1]-a[1]).slice(0,10);
  const maxV=sorted[0]?.[1]||1;
  document.getElementById('chart-cat').innerHTML=sorted.map(([c,v])=>`<div class="bar-row"><div class="bar-label">${c}</div><div class="bar-track"><div class="bar-fill" style="width:${v/maxV*100}%;background:${getCatColor(c,grupos)}"></div></div><div class="bar-val">${fmt(v)}</div></div>`).join('')||'<div class="empty-state">Sin datos</div>';
  const meses=getMeses();
  const maxIG=Math.max(...meses.map(m=>Math.max(getMes(m).filter(d=>d.tipo==='ingreso').reduce((s,d)=>s+d.monto,0),getGastosImpacto(m).reduce((s,d)=>s+d.monto,0))),1);
  document.getElementById('chart-ing-gas').innerHTML=meses.map(m=>{
    const ing=getMes(m).filter(d=>d.tipo==='ingreso').reduce((s,d)=>s+d.monto,0);
    const gas=getGastosImpacto(m).reduce((s,d)=>s+d.monto,0);
    return`<div style="margin-bottom:8px"><div style="font-size:10px;font-family:'DM Mono',monospace;color:var(--text2);margin-bottom:3px">${NOMBRES_MES[m]||m}</div><div class="bar-row" style="margin-bottom:2px"><div class="bar-label" style="color:var(--accent)">Ingresos</div><div class="bar-track"><div class="bar-fill" style="width:${ing/maxIG*100}%;background:var(--accent)"></div></div><div class="bar-val">${fmt(ing)}</div></div><div class="bar-row"><div class="bar-label" style="color:var(--danger)">Gastos</div><div class="bar-track"><div class="bar-fill" style="width:${gas/maxIG*100}%;background:var(--danger)"></div></div><div class="bar-val">${fmt(gas)}</div></div></div>`;
  }).join('');
}

function renderRecientes(){
  const rec=[...datos].filter(d=>d.tipo==='gasto'&&!d.esCuotaFutura).sort((a,b)=>(b.fecha||'').localeCompare(a.fecha||'')).slice(0,10);
  const el=document.getElementById('tbody-recientes');if(!el)return;
  el.innerHTML=rec.map(d=>{
    const t=d.cuenta&&TARJETAS_META[d.cuenta];
    return`<tr><td class="text-mono" style="color:var(--text2);font-size:11px">${d.fecha}</td><td>${quienBadge(d.quien)}</td><td>${d.desc}</td><td><span style="display:inline-block;width:7px;height:7px;border-radius:50%;background:${getCatColor(d.categoria,grupos)};margin-right:5px"></span>${d.categoria}</td><td>${t?`<span style="color:${t.color};font-family:'DM Mono',monospace;font-weight:700">${d.cuenta}</span>`:'-'}</td><td>${d.cuenta?`<span class="resumen-badge">${NOMBRES_MES_L[d.mesResumen]||d.mesResumen||'-'}</span>`:'-'}</td><td class="monto-negativo">-${fmt(d.monto)}</td></tr>`;
  }).join('')||'<tr><td colspan="7" class="empty-state">Cargando...</td></tr>';
}

function renderMovimientos(){
  const fM=document.getElementById('fil-mes')?.value||'';
  const fT=document.getElementById('fil-tipo')?.value||'';
  const fQ=document.getElementById('fil-quien')?.value||'';
  const fC=document.getElementById('fil-cat')?.value||'';
  const fTar=document.getElementById('fil-tarjeta')?.value||'';
  const fCuotas=document.getElementById('fil-cuotas')?.value||'';
  const fB=document.getElementById('fil-buscar')?.value.toLowerCase()||'';
  
  let mv=[...datos].sort((a,b)=>(b.fecha||'').localeCompare(a.fecha||''));
  if(fM)mv=mv.filter(d=>d.tipo==='ingreso'?d.fecha&&d.fecha.startsWith(fM):d.mesResumen&&d.mesResumen.startsWith(fM));
  if(fT)mv=mv.filter(d=>d.tipo===fT);
  if(fQ)mv=mv.filter(d=>d.quien===fQ);
  if(fC)mv=mv.filter(d=>d.categoria===fC);
  if(fTar){if(fTar==='efectivo')mv=mv.filter(d=>!d.cuenta);else mv=mv.filter(d=>d.cuenta===fTar);}
  if(fCuotas==='cuota')mv=mv.filter(d=>d.esCuota);
  else if(fCuotas==='normal')mv=mv.filter(d=>!d.esCuota);
  else if(fCuotas==='futura')mv=mv.filter(d=>d.esCuotaFutura);
  if(fB)mv=mv.filter(d=>(d.desc||'').toLowerCase().includes(fB)||(d.categoria||'').toLowerCase().includes(fB));

  const tot=mv.filter(d=>!d.esCuotaFutura).reduce((s,d)=>s+(d.tipo==='ingreso'?d.monto:-d.monto),0);
  document.getElementById('mov-count').textContent=`${mv.length} movimientos`;
  document.getElementById('mov-total').textContent=`Balance real: ${tot>=0?'+':''}${fmt(tot)}`;
  
  const tbody=document.getElementById('tbody-movimientos');if(!tbody)return;
  tbody.innerHTML=mv.map(d=>{
    const t=d.cuenta&&TARJETAS_META[d.cuenta];
    const montoClass=d.esCuotaFutura?'monto-futura':d.tipo==='ingreso'?'monto-positivo':'monto-negativo';
    const montoPrefix=d.tipo==='ingreso'?'+':'-';
    const cuotaLabel=d.esCuotaFutura?`<span class="futura-badge">üìÖ proyectada</span>`:d.esCuota?`<span class="cuota-badge">üîÑ cuota</span>`:'';
    return`<tr style="${d.esCuotaFutura?'opacity:.65':''}"><td class="text-mono" style="color:var(--text2);font-size:11px">${d.fecha}</td><td>${quienBadge(d.quien)}</td><td>${d.desc} ${cuotaLabel}</td><td><span style="display:inline-block;width:7px;height:7px;border-radius:50%;background:${getCatColor(d.categoria,grupos)};margin-right:5px"></span>${d.categoria}</td><td>${t?`<span style="color:${t.color};font-family:'DM Mono',monospace;font-weight:700">${d.cuenta}</span>`:'-'}</td><td>${d.cuenta&&d.tipo==='gasto'?`<span class="resumen-badge">${NOMBRES_MES_L[d.mesResumen]||d.mesResumen||'-'}</span>`:'-'}</td><td class="${montoClass}">${montoPrefix}${fmt(d.monto)}</td><td>${!d.esCuotaFutura?`<button class="btn-icon" onclick="window.eliminar('${d._fbId}')">‚úï</button>`:''}</td></tr>`;
  }).join('')||'<tr><td colspan="8" class="empty-state">Sin resultados</td></tr>';
}

function renderResumenes(){
  const el=document.getElementById('info-resumenes');
  if(el){
    const futuras=datos.filter(d=>d.tipo==='gasto'&&d.mesResumen===mesRes&&d.esCuotaFutura);
    const reales=datos.filter(d=>d.tipo==='gasto'&&d.mesResumen===mesRes&&!d.esCuotaFutura);
    const totFuturas=futuras.reduce((s,d)=>s+d.monto,0);
    el.innerHTML=`<strong>Res√∫menes de ${NOMBRES_MES_L[mesRes]||mesRes}</strong>${totFuturas>0?` ¬∑ Incl. <span style="color:#a78bfa">${fmt(totFuturas)} en cuotas proyectadas</span>`:''}`;
  }
  const grid=document.getElementById('tarjetas-grid'),hoy=new Date();
  if(grid){grid.innerHTML=Object.entries(TARJETAS_META).map(([id,tc])=>{
    const gastos=datos.filter(d=>d.tipo==='gasto'&&d.mesResumen===mesRes&&d.cuenta===id);
    const total=gastos.reduce((s,d)=>s+d.monto,0);
    const totalFuturo=gastos.filter(d=>d.esCuotaFutura).reduce((s,d)=>s+d.monto,0);
    const p=periodos[id]&&periodos[id][mesRes];
    let vtoLabel='Sin per√≠odo',vtoClass='vto-ok';
    if(p){const vtoDate=new Date(p.vto+'T12:00:00');const diff=Math.ceil((vtoDate-hoy)/(1000*60*60*24));if(diff<0){vtoLabel=`Venci√≥ hace ${Math.abs(diff)}d`;vtoClass='vto-urgente';}else if(diff===0){vtoLabel='Vence hoy';vtoClass='vto-urgente';}else if(diff<=5){vtoLabel=`Vence en ${diff}d`;vtoClass='vto-urgente';}else if(diff<=10){vtoLabel=`Vence en ${diff}d`;vtoClass='vto-pronto';}else{vtoLabel=`Vence ${p.vto.slice(8,10)}/${p.vto.slice(5,7)}`;vtoClass='vto-ok';}}
    if(total===0)return'';
    return`<div class="tarjeta-card tc-${id}"><div class="tarjeta-nombre">${id} ¬∑ ${tc.nombre}</div><div class="tarjeta-info">${p?'Cierre '+p.cierre.slice(8,10)+'/'+p.cierre.slice(5,7):'‚Äî'} ¬∑ ${gastos.length} gastos</div><div class="tarjeta-monto" style="color:var(--danger)">${fmt(total)}</div>${totalFuturo>0?`<div style="font-size:10px;font-family:'DM Mono',monospace;color:#a78bfa">incl. ${fmt(totalFuturo)} proyectado</div>`:''}${p?`<span class="tarjeta-vto ${vtoClass}">${vtoLabel}</span>`:''}`;
  }).filter(Boolean).join('');}
  
  const gm=datos.filter(d=>d.tipo==='gasto'&&d.mesResumen===mesRes).sort((a,b)=>(a.cuenta||'').localeCompare(b.cuenta||''));
  const total=gm.reduce((s,d)=>s+d.monto,0);
  const tit=document.getElementById('res-titulo');if(tit)tit.textContent=`Detalle ¬∑ ${NOMBRES_MES_L[mesRes]||mesRes} ¬∑ Total: ${fmt(total)}`;
  const tbody=document.getElementById('tbody-resumenes');if(!tbody)return;
  tbody.innerHTML=gm.map(d=>{
    const t=TARJETAS_META[d.cuenta];
    const style=d.esCuotaFutura?'opacity:.65':'';
    return`<tr style="${style}"><td class="text-mono" style="color:var(--text2);font-size:11px">${d.fecha}</td><td>${quienBadge(d.quien)}</td><td>${d.desc}${d.esCuotaFutura?' <span class="futura-badge">proyectada</span>':''}</td><td><span style="display:inline-block;width:7px;height:7px;border-radius:50%;background:${getCatColor(d.categoria,grupos)};margin-right:5px"></span>${d.categoria}</td><td>${t?`<span style="color:${t.color};font-family:'DM Mono',monospace;font-weight:700">${d.cuenta}</span>`:'Efec/D√©b'}</td><td class="${d.esCuotaFutura?'monto-futura':'monto-negativo'}">-${fmt(d.monto)}</td></tr>`;
  }).join('')||'<tr><td colspan="6" class="empty-state">Sin gastos</td></tr>';
}

function renderConfigTarjetas(){
  const el=document.getElementById('config-tarjetas-content');if(!el)return;
  const mm=[...new Set([...getMeses(),...getMesesResumen()])].sort();
  // Add future months if not present
  const last=mm[mm.length-1]||'2026-02';
  let cur=new Date(last+'-01');
  for(let i=0;i<6;i++){cur.setMonth(cur.getMonth()+1);const s=cur.toISOString().slice(0,7);if(!mm.includes(s))mm.push(s);}
  el.innerHTML=Object.entries(TARJETAS_META).map(([id,tc])=>{
    const rows=mm.map(mes=>{const p=(periodos[id]&&periodos[id][mes])||{cierre:'',vto:''};return`<tr><td style="font-weight:700;color:var(--text)">${NOMBRES_MES_L[mes]||mes}</td><td><input type="date" value="${p.cierre}" onchange="window.updatePeriodo('${id}','${mes}','cierre',this.value)"></td><td><input type="date" value="${p.vto}" onchange="window.updatePeriodo('${id}','${mes}','vto',this.value)"></td></tr>`;}).join('');
    return`<div class="settings-section"><h3 style="color:${tc.color}">${id} ¬∑ ${tc.nombre}</h3><table class="periodos-table"><thead><tr><th>Mes</th><th>Cierre</th><th>Vencimiento</th></tr></thead><tbody>${rows}</tbody></table></div>`;
  }).join('');
}

window.updatePeriodo=async(tarjetaId,mes,campo,valor)=>{
  if(!periodos[tarjetaId])periodos[tarjetaId]={};
  if(!periodos[tarjetaId][mes])periodos[tarjetaId][mes]={cierre:'',vto:''};
  periodos[tarjetaId][mes][campo]=valor;
  const afectados=datos.filter(d=>d.cuenta===tarjetaId&&d.tipo==='gasto'&&!d.esCuotaFutura);
  for(const d of afectados){
    const nuevoMr=calcularMesResumen(d.fecha,d.cuenta,periodos);
    if(nuevoMr!==d.mesResumen)await setDoc(doc(db,'movimientos',d._fbId),{...d,mesResumen:nuevoMr},{merge:true});
  }
  await guardarConfig();
};

function renderCategorias(){
  const mv=getGastosImpacto(mesCat).filter(d=>!d.esCuotaFutura);
  const cm={};mv.forEach(d=>{if(!cm[d.categoria])cm[d.categoria]={total:0,count:0};cm[d.categoria].total+=d.monto;cm[d.categoria].count++;});
  const totG=Object.values(cm).reduce((s,v)=>s+v.total,0)||1;
  const fc=Object.entries(cm).filter(([c])=>getCatGrupo(c,grupos)?.id==='fijo').sort((a,b)=>b[1].total-a[1].total);
  const vc=Object.entries(cm).filter(([c])=>getCatGrupo(c,grupos)?.id==='variable').sort((a,b)=>b[1].total-a[1].total);
  const mF=fc[0]?.[1].total||1,mV=vc[0]?.[1].total||1;
  document.getElementById('chart-fijos').innerHTML=fc.map(([c,v])=>`<div class="bar-row"><div class="bar-label">${c}</div><div class="bar-track"><div class="bar-fill" style="width:${v.total/mF*100}%;background:${getCatColor(c,grupos)}"></div></div><div class="bar-val">${fmt(v.total)}</div></div>`).join('')||'<div class="empty-state">Sin datos</div>';
  document.getElementById('chart-variables').innerHTML=vc.map(([c,v])=>`<div class="bar-row"><div class="bar-label">${c}</div><div class="bar-track"><div class="bar-fill" style="width:${v.total/mV*100}%;background:${getCatColor(c,grupos)}"></div></div><div class="bar-val">${fmt(v.total)}</div></div>`).join('')||'<div class="empty-state">Sin datos</div>';
  const GL={fijo:'Fijo',variable:'Variable',financiero:'Fin/Salud'};
  document.getElementById('tbody-cat').innerHTML=Object.entries(cm).sort((a,b)=>b[1].total-a[1].total).map(([c,v])=>{const g=getCatGrupo(c,grupos);return`<tr><td><span style="display:inline-block;width:8px;height:8px;border-radius:2px;background:${getCatColor(c,grupos)};margin-right:8px"></span>${c}</td><td>${g?`<span class="grupo-tag grupo-${g.id}">${GL[g.id]||g.id}</span>`:''}</td><td class="text-mono">${v.count}</td><td class="monto-negativo">-${fmt(v.total)}</td><td class="text-mono" style="color:var(--text2)">${Math.round(v.total/totG*100)}%</td></tr>`;}).join('')||'<tr><td colspan="5" class="empty-state">Sin datos</td></tr>';
}

function renderComparativa(){
  const meses=getMeses();
  const stats=meses.map(m=>{const mv=getMes(m);const ing=mv.filter(d=>d.tipo==='ingreso').reduce((s,d)=>s+d.monto,0);const gas=getGastosImpacto(m).reduce((s,d)=>s+d.monto,0);const fijo=getGastosImpacto(m).filter(d=>getCatGrupo(d.categoria,grupos)?.id==='fijo').reduce((s,d)=>s+d.monto,0);const vari=getGastosImpacto(m).filter(d=>getCatGrupo(d.categoria,grupos)?.id==='variable').reduce((s,d)=>s+d.monto,0);return{mes:m,nombre:NOMBRES_MES[m]||m,ing,gas,bal:ing-gas,fijo,vari};});
  const el=document.getElementById('kpis-comp');
  if(el&&stats.length>=2){const last=stats[stats.length-1],prev=stats[stats.length-2],dG=last.gas-prev.gas;el.innerHTML=`<div class="kpi green"><div class="kpi-label">Ingresos ${last.nombre}</div><div class="kpi-value" style="color:var(--accent)">${fmt(last.ing)}</div><div class="kpi-sub">vs ${fmt(prev.ing)}</div></div><div class="kpi ${dG>0?'red':'green'}"><div class="kpi-label">Gastos ${last.nombre}</div><div class="kpi-value" style="color:${dG>0?'var(--danger)':'var(--accent)'}">${fmt(last.gas)}</div><div class="kpi-sub">${dG>0?'‚Üë':'‚Üì'} ${fmt(Math.abs(dG))}</div></div><div class="kpi ${last.bal>=0?'green':'red'}"><div class="kpi-label">Balance</div><div class="kpi-value" style="color:${last.bal>=0?'var(--accent)':'var(--danger)'}">${fmt(last.bal)}</div><div class="kpi-sub">${last.bal>=0?'Super√°vit':'D√©ficit'}</div></div><div class="kpi yellow"><div class="kpi-label">Fijos ${last.nombre}</div><div class="kpi-value" style="color:var(--accent3)">${fmt(last.fijo)}</div><div class="kpi-sub">vs ${fmt(prev.fijo)}</div></div>`;}
  const mIG=Math.max(...stats.map(s=>Math.max(s.ing,s.gas)),1),mFV=Math.max(...stats.map(s=>Math.max(s.fijo,s.vari)),1);
  const mk=(s,v1,v2,c1,c2,l1,l2,max)=>`<div style="margin-bottom:10px"><div style="font-size:11px;font-weight:700;margin-bottom:3px">${s.nombre}</div><div class="bar-row" style="margin-bottom:2px"><div class="bar-label" style="color:${c1}">${l1}</div><div class="bar-track"><div class="bar-fill" style="width:${v1/max*100}%;background:${c1}"></div></div><div class="bar-val">${fmt(v1)}</div></div><div class="bar-row"><div class="bar-label" style="color:${c2}">${l2}</div><div class="bar-track"><div class="bar-fill" style="width:${v2/max*100}%;background:${c2}"></div></div><div class="bar-val">${fmt(v2)}</div></div></div>`;
  const el1=document.getElementById('chart-comp1');if(el1)el1.innerHTML=stats.map(s=>mk(s,s.ing,s.gas,'var(--accent)','var(--danger)','Ingresos','Gastos',mIG)).join('');
  const el2=document.getElementById('chart-comp2');if(el2)el2.innerHTML=stats.map(s=>mk(s,s.fijo,s.vari,'var(--accent2)','var(--accent3)','Fijos','Variables',mFV)).join('');
}

function renderConfig(){
  const el=document.getElementById('config-grupos');if(!el)return;
  const GL={fijo:'üîµ Gastos Fijos',variable:'üü° Gastos Variables',financiero:'üü£ Financieros / Salud',ingreso:'üü¢ Ingresos'};
  el.innerHTML=grupos.map(g=>`<div class="settings-section"><h3>${GL[g.id]||g.nombre}</h3><div class="cat-list">${g.cats.map(cat=>`<div class="cat-item"><span style="display:inline-block;width:10px;height:10px;border-radius:3px;background:${getCatColor(cat,grupos)}"></span><span class="cat-item-name">${cat}</span><button class="btn btn-danger btn-sm" onclick="window.eliminarCat('${g.id}','${cat.replace(/'/g,"\\'")}')" >‚úï</button></div>`).join('')}</div></div>`).join('');
}

function actualizarCatsFiltro(){const el=document.getElementById('fil-cat');if(!el)return;el.innerHTML='<option value="">Todas las categor√≠as</option>'+grupos.flatMap(g=>g.cats).map(c=>`<option value="${c}">${c}</option>`).join('');}
function actualizarCatsModal(){const tipo=document.getElementById('m-tipo')?.value||'gasto';const sel=document.getElementById('m-cat');if(!sel)return;const gs=tipo==='ingreso'?grupos.filter(g=>g.id==='ingreso'):grupos.filter(g=>g.id!=='ingreso');sel.innerHTML=gs.flatMap(g=>g.cats.map(c=>`<option value="${c}">${c}</option>`)).join('');}
window.actualizarCatsModal=actualizarCatsModal;

window.toggleCuotas=function(){
  const cuenta=document.getElementById('m-cuenta')?.value;
  const row=document.getElementById('cuotas-row');
  if(row)row.style.display=cuenta?'block':'none';
  calcularResumen();
};

function calcularResumen(){
  const fecha=document.getElementById('m-fecha')?.value,tarjeta=document.getElementById('m-cuenta')?.value,tipo=document.getElementById('m-tipo')?.value||'gasto';
  const cuotas=parseInt(document.getElementById('m-cuotas')?.value||'1');
  const monto=parseFloat(document.getElementById('m-monto')?.value||'0');
  const row=document.getElementById('resumen-info-row'),infoEl=document.getElementById('resumen-info');
  if(!row||!infoEl)return;
  if(tipo==='ingreso'||!tarjeta||!fecha){row.style.display='none';return;}
  row.style.display='block';
  const tc=TARJETAS_META[tarjeta];if(!tc){row.style.display='none';return;}
  const info=getCierreInfo(fecha,tarjeta,periodos);
  const mesImpacto=calcularMesResumen(fecha,tarjeta,periodos);
  if(info){
    const dias=Math.ceil((new Date(info.cierreStr+'T12:00:00')-new Date(fecha+'T12:00:00'))/(1000*60*60*24));
    const montoCuota=cuotas>1&&monto>0?` ¬∑ cuota: ${fmt(monto/cuotas)}`:''    ;
    infoEl.className='info-box ok';
    infoEl.innerHTML=`üí≥ <strong style="color:${tc.color}">${tc.nombre}</strong> ¬∑ Cierre: <strong>${info.cierreStr.slice(8,10)}/${info.cierreStr.slice(5,7)}</strong> (${dias}d) ¬∑ Vence: <strong>${info.vtoStr.slice(8,10)}/${info.vtoStr.slice(5,7)}</strong> ‚Üí 1¬™ cuota en <strong>${NOMBRES_MES_L[mesImpacto]||mesImpacto}</strong>${montoCuota}`;
  } else {infoEl.className='info-box warn';infoEl.innerHTML='‚ö†Ô∏è Sin per√≠odo configurado para esta tarjeta.';}
}
window.calcularResumen=calcularResumen;

window.abrirModal=()=>{
  document.getElementById('m-tipo').value='gasto';actualizarCatsModal();
  document.getElementById('m-monto').value='';document.getElementById('m-desc').value='';
  document.getElementById('m-cuenta').value='';document.getElementById('m-cuotas').value='1';
  document.getElementById('resumen-info-row').style.display='none';
  document.getElementById('cuotas-row').style.display='none';
  document.getElementById('m-fecha').value=new Date().toISOString().slice(0,10);
  document.getElementById('modal-overlay').classList.remove('hidden');
};
window.cerrarModal=()=>document.getElementById('modal-overlay').classList.add('hidden');

window.guardarMovimiento=async()=>{
  const monto=parseFloat(document.getElementById('m-monto').value);
  const fecha=document.getElementById('m-fecha').value;
  const desc=document.getElementById('m-desc').value.trim();
  const tipo=document.getElementById('m-tipo').value;
  const cuenta=document.getElementById('m-cuenta').value;
  const cuotas=parseInt(document.getElementById('m-cuotas')?.value||'1');
  const categoria=document.getElementById('m-cat').value;
  if(!monto||!fecha||!desc)return alert('Complet√° fecha, monto y descripci√≥n');
  
  if(tipo==='ingreso'||!cuenta||cuotas===1){
    const mesResumen=tipo==='gasto'?calcularMesResumen(fecha,cuenta,periodos):fecha.slice(0,7);
    await addDoc(collection(db,'movimientos'),{fecha,tipo,monto,moneda:'ARS',categoria,cuenta,desc,mesResumen,quien:'Leo',esCuota:false,esCuotaFutura:false,timestamp:Date.now()});
  } else {
    // Pago en cuotas: generar una cuota por mes
    const montoCuota=Math.round(monto/cuotas);
    const primerMes=calcularMesResumen(fecha,cuenta,periodos);
    const [py,pm]=primerMes.split('-').map(Number);
    const batch=[];
    for(let i=0;i<cuotas;i++){
      let tm=pm+i,ty=py;
      while(tm>12){tm-=12;ty++;}
      const mesResumen=`${ty}-${String(tm).padStart(2,'0')}`;
      const esFutura=i>0; // primera cuota es real, resto son proyectadas
      batch.push(addDoc(collection(db,'movimientos'),{
        fecha,tipo:'gasto',monto:montoCuota,moneda:'ARS',categoria,cuenta,
        desc:`${desc} ‚Äî cuota ${i+1}/${cuotas}`,
        mesResumen,quien:'Leo',esCuota:true,esCuotaFutura:esFutura,
        cuotaActual:i+1,cuotaTotal:cuotas,timestamp:Date.now()
      }));
    }
    await Promise.all(batch);
  }
  cerrarModal();
};

window.eliminar=async(fbId)=>{if(!confirm('¬øEliminar?'))return;await deleteDoc(doc(db,'movimientos',fbId));};
window.agregarCategoria=async()=>{
  const nombre=document.getElementById('new-cat-name').value.trim();const gid=document.getElementById('new-cat-grupo').value;
  if(!nombre)return alert('Escrib√≠ un nombre');
  const g=grupos.find(g=>g.id===gid);
  if(g&&!g.cats.includes(nombre)){g.cats.push(nombre);await guardarConfig();actualizarCatsFiltro();actualizarCatsModal();renderConfig();}
  else alert('Esa categor√≠a ya existe');
  document.getElementById('new-cat-name').value='';
};
window.eliminarCat=async(gid,cat)=>{
  if(datos.some(d=>d.categoria===cat)&&!confirm(`"${cat}" tiene movimientos. ¬øElimin√°s igual?`))return;
  const g=grupos.find(g=>g.id===gid);if(g){g.cats=g.cats.filter(c=>c!==cat);await guardarConfig();renderConfig();actualizarCatsFiltro();actualizarCatsModal();}
};
window.exportarCSV=()=>{
  const h='Fecha,Qui√©n,Tipo,Descripci√≥n,Categor√≠a,Tarjeta,Resumen,Monto,Cuota,Proyectada\n';
  const r=[...datos].sort((a,b)=>(a.fecha||'').localeCompare(b.fecha||'')).map(d=>`${d.fecha},${d.quien||'Leo'},${d.tipo},"${d.desc}",${d.categoria},${d.cuenta||'efectivo'},${d.mesResumen||''},${d.monto},${d.esCuota?'si':'no'},${d.esCuotaFutura?'si':'no'}`).join('\n');
  const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([h+r],{type:'text/csv'}));a.download='finanzas_2026.csv';a.click();
};
window.onclick=e=>{if(e.target===document.getElementById('modal-overlay'))cerrarModal();};
actualizarCatsFiltro();
</script>
</body>
</html>
